{"title":"Multinomial","markdown":{"yaml":{"title":"Multinomial","format":{"html":{"toc":true,"html-math-method":"katex","css":"style.css","theme":{"light":"cosmo","dark":["cosmo","theme-dark.scss"]}}},"execute":{"echo":false},"editor_options":{"chunk_output_type":"console"}},"headingText":"Multinomial probability distribution","containsRefs":false,"markdown":"\n\n```{=html}\n<style>\n.table-hover > tbody > tr:hover { \n  background-color: #f4f442;\n}\n</style>\n```\n\n```{r message=FALSE, warning=FALSE, include=FALSE}\nlibrary(here)\nsource(here(\"source\",\"get_lib.R\"))\n```\n\n-   Reading\n    -   Ch.3\n        -   skip 3.4.3, 3.5 (page )\n\n\n\n-   Suppose `Y` is categorical response random variable and we have `n` trials, $Y_1..Y_n$\n-   $N_j$ counts the number of trials responding with category `j`.\n    -   $N_j = \\sum_{i=1}^n I(Y_i=j)$\n-   parameters:\n    -   number of category, `j=1,...J`\n    -   probability associated with each category $\\pi_j = P(Y=j)$\n-   It is distribution, so\n\n$$\\sum_{j=1}^J \\pi_j = 1$$\n\n-   Then, PMF of observing a particular set of counts $n_1,...n_j$ is\n\n$$P(N_1 = n_1,....N_j = J) = \\frac{n!}{\\prod_{j=1}^{J}n_j!}\\prod_{j=1}^{J}\\pi_j^{n_j}$$\n\nThis is known as the `multinomial probability distribution`\n\n-   We use MLE to obtain estimates of $\\pi_1,...\\pi_J$ which is $\\hat{\\pi} = \\frac{n_j}{n}$, which is the observed proportion for each category.\n\n\n# One Multinomial distribution\n\n-   This is different from `multinomial distribution`.\n-   Well... here is an example [LINK](https://docs.google.com/spreadsheets/d/1YyO_sX1hIn7siATwF7L-mE8OfHktGX2w/edit?gid=139180726#gid=139180726)\n\n```{r}\n#| echo: true\npi.ij <- c(0.2, 0.3, 0.2, 0.1, 0.1, 0.1)\npi.table <- array(data = pi.ij , dim = c(2,3), dimnames = list(X\n= 1:2, Y = 1:3))\n\npi.table %>% kable(\"html\") %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n```{r}\n#| echo: true\nset.seed(9812)  \n\nsave <- rmultinom(n = 1, size = 1000, prob = pi.ij)  \n\nc.table1 <- array(data = save , dim = c(2,3), dimnames = list(X\n= 1:2, Y = 1:3))\n\nc.table1/sum(c.table1)\n\nrowSums(c.table1)\n```\n\n# Product Multinomial distribution\n\n-   For the I multinomial (i.e., product multinomial) setting, we again simulate a sample for a 2 × 3 contingency table (thus, I = 2).\n-   With this model, we need to draw samples of fixed size separately for each row.\n  - Question is can we get joint probability using this method?\n-   Here is an example from book\n\n## This part is preparing the data set part\n\n```{r}\n#| echo: true\n#calculate conditional probability \npi.cond <- pi.table/rowSums(pi.table)\npi.cond %>% kable(\"html\") %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"))\n\n#simulate based on the conditional probability\n#notice the sample size is different from c.table1\n#suppose that we sampled 400 and 600.  This is just what was \n#observed or we selected this\nset.seed(8111) \nsave1 <- rmultinom(n = 1, size = 400, prob = pi.cond[1,]) \nsave2 <- rmultinom(n = 1, size = 600, prob = pi.cond[2,])\n\nc.table2 <- array(data = c(save1[1], save2[1], save1[2],\nsave2[2], save1[3], save2 [3]), dim = c(2,3), dimnames = list(X = 1:2, Y = 1:3))\n\nc.table2 %>% kable(\"html\") %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n-   `Can we estimate the joint from this table?` is the question.\n\n    -   Answer is, `yes`\n\n```{r}\n    c.table2/rowSums(c.table2)\n```\n\n-   Now, we have joint and marginal, can we test independence?\n\n# Testing for independence\n\n- See page 148\n\n$$H_0: P(X=x_i,Y=y_j) = P(x_i)\\cdot P(y_j)$$ $$H_a: P(X=x_i,Y=y_j) \\not= P(x_i)\\cdot P(y_j)$$ Using the book notation in p147,\n\n$$H_0: \\pi_{ij}=\\pi_{i+}\\pi_{+j} \\text{  for each i,j}$$ $$H_0: \\pi_{ij}\\not=\\pi_{i+}\\pi_{+j} \\text{  for some i,j}$$\n\n### Compare test statistic and $\\chi^2$\n\n-   This is called `Pearson Chi-square test`\n-   Under product multinomial model (see page 147), this is how you compute the test statistics\n\n$$\\text{X}^2 = \\frac{\\text{difference between joint and product of marginal}}{\\text{product of marginal}}$$\n\n-   Above statistic has an approximate $\\chi^2$ distribution with certain degrees of freedom\n\n-   After you set your type I error, $\\alpha$, you get your crtical value and compare that critical value with your observed test statistic $\\text{X}^2$\n\n### LR test\n\n-   This is called LRT test\n-   The likelihood ratio test can also be conducted.\n    -   The joint probability can be computed in two different ways\n        -   From contingency table, just calculate it.\n        -   And using the marginal probabilities, multiply them.\n    -   Then, using equation 3.2 in page 143, you can calculate the likelihood of both and form `the likelihood ratio`\n\n$$\\lambda = \\frac{\\text{the MLF estimated using joint probabilites}}{\\text{the MLF estimated using joint probabilities estimated as the product of marginal}}$$\n\nAnd $-2\\text{log}(\\lambda)$, also follows $\\chi^2$ distribution with certain degrees of freedom. (this sounds like a magic.. to me..)\n\n### Note\n\n-   Both LRT and the Pearson chi-square test generally give similiar result in large samples. (see page 147)\n    -   common criteria $\\frac{\\text{product of marginal counts}}{\\text{total count}} > 1$ or $>5$ for all cells of the contingency table\n\n# Example of Testing Independnece \n\n-   We would like to determine if `bloating severity` is related to the `type of fiber`.\n\n```{r}\ndiet <- read.csv(here(\"data\",\"Fiber.csv\"), stringsAsFactors = TRUE)\n\n# Match order given in table\ndiet$fiber <- factor(x = diet$fiber, levels = c(\"none\", \"bran\", \"gum\", \"both\"))\ndiet$bloat <- factor(x = diet$bloat, levels = c(\"none\", \"low\", \"medium\", \"high\"))\n\ndiet.table <- xtabs(formula = count ~ fiber + bloat, data = diet)\ndiet.table\n```\n\n```{r}\n# Hypothesis tests for independence\nind.test <- chisq.test(x = diet.table, correct = FALSE)\nind.test\n```\n\n-   Note that we include the `correct = FALSE` argument value in `chisq.test()` to prevent a continuity correction from being applied.\n    -   Please see Section 1.2.3 for why we avoid these corrections.\n\n```{r}\nind.test$expected\n```\n\n","srcMarkdownNoYaml":"\n\n```{=html}\n<style>\n.table-hover > tbody > tr:hover { \n  background-color: #f4f442;\n}\n</style>\n```\n\n```{r message=FALSE, warning=FALSE, include=FALSE}\nlibrary(here)\nsource(here(\"source\",\"get_lib.R\"))\n```\n\n-   Reading\n    -   Ch.3\n        -   skip 3.4.3, 3.5 (page )\n\n\n# Multinomial probability distribution\n\n-   Suppose `Y` is categorical response random variable and we have `n` trials, $Y_1..Y_n$\n-   $N_j$ counts the number of trials responding with category `j`.\n    -   $N_j = \\sum_{i=1}^n I(Y_i=j)$\n-   parameters:\n    -   number of category, `j=1,...J`\n    -   probability associated with each category $\\pi_j = P(Y=j)$\n-   It is distribution, so\n\n$$\\sum_{j=1}^J \\pi_j = 1$$\n\n-   Then, PMF of observing a particular set of counts $n_1,...n_j$ is\n\n$$P(N_1 = n_1,....N_j = J) = \\frac{n!}{\\prod_{j=1}^{J}n_j!}\\prod_{j=1}^{J}\\pi_j^{n_j}$$\n\nThis is known as the `multinomial probability distribution`\n\n-   We use MLE to obtain estimates of $\\pi_1,...\\pi_J$ which is $\\hat{\\pi} = \\frac{n_j}{n}$, which is the observed proportion for each category.\n\n\n# One Multinomial distribution\n\n-   This is different from `multinomial distribution`.\n-   Well... here is an example [LINK](https://docs.google.com/spreadsheets/d/1YyO_sX1hIn7siATwF7L-mE8OfHktGX2w/edit?gid=139180726#gid=139180726)\n\n```{r}\n#| echo: true\npi.ij <- c(0.2, 0.3, 0.2, 0.1, 0.1, 0.1)\npi.table <- array(data = pi.ij , dim = c(2,3), dimnames = list(X\n= 1:2, Y = 1:3))\n\npi.table %>% kable(\"html\") %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n```{r}\n#| echo: true\nset.seed(9812)  \n\nsave <- rmultinom(n = 1, size = 1000, prob = pi.ij)  \n\nc.table1 <- array(data = save , dim = c(2,3), dimnames = list(X\n= 1:2, Y = 1:3))\n\nc.table1/sum(c.table1)\n\nrowSums(c.table1)\n```\n\n# Product Multinomial distribution\n\n-   For the I multinomial (i.e., product multinomial) setting, we again simulate a sample for a 2 × 3 contingency table (thus, I = 2).\n-   With this model, we need to draw samples of fixed size separately for each row.\n  - Question is can we get joint probability using this method?\n-   Here is an example from book\n\n## This part is preparing the data set part\n\n```{r}\n#| echo: true\n#calculate conditional probability \npi.cond <- pi.table/rowSums(pi.table)\npi.cond %>% kable(\"html\") %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"))\n\n#simulate based on the conditional probability\n#notice the sample size is different from c.table1\n#suppose that we sampled 400 and 600.  This is just what was \n#observed or we selected this\nset.seed(8111) \nsave1 <- rmultinom(n = 1, size = 400, prob = pi.cond[1,]) \nsave2 <- rmultinom(n = 1, size = 600, prob = pi.cond[2,])\n\nc.table2 <- array(data = c(save1[1], save2[1], save1[2],\nsave2[2], save1[3], save2 [3]), dim = c(2,3), dimnames = list(X = 1:2, Y = 1:3))\n\nc.table2 %>% kable(\"html\") %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n-   `Can we estimate the joint from this table?` is the question.\n\n    -   Answer is, `yes`\n\n```{r}\n    c.table2/rowSums(c.table2)\n```\n\n-   Now, we have joint and marginal, can we test independence?\n\n# Testing for independence\n\n- See page 148\n\n$$H_0: P(X=x_i,Y=y_j) = P(x_i)\\cdot P(y_j)$$ $$H_a: P(X=x_i,Y=y_j) \\not= P(x_i)\\cdot P(y_j)$$ Using the book notation in p147,\n\n$$H_0: \\pi_{ij}=\\pi_{i+}\\pi_{+j} \\text{  for each i,j}$$ $$H_0: \\pi_{ij}\\not=\\pi_{i+}\\pi_{+j} \\text{  for some i,j}$$\n\n### Compare test statistic and $\\chi^2$\n\n-   This is called `Pearson Chi-square test`\n-   Under product multinomial model (see page 147), this is how you compute the test statistics\n\n$$\\text{X}^2 = \\frac{\\text{difference between joint and product of marginal}}{\\text{product of marginal}}$$\n\n-   Above statistic has an approximate $\\chi^2$ distribution with certain degrees of freedom\n\n-   After you set your type I error, $\\alpha$, you get your crtical value and compare that critical value with your observed test statistic $\\text{X}^2$\n\n### LR test\n\n-   This is called LRT test\n-   The likelihood ratio test can also be conducted.\n    -   The joint probability can be computed in two different ways\n        -   From contingency table, just calculate it.\n        -   And using the marginal probabilities, multiply them.\n    -   Then, using equation 3.2 in page 143, you can calculate the likelihood of both and form `the likelihood ratio`\n\n$$\\lambda = \\frac{\\text{the MLF estimated using joint probabilites}}{\\text{the MLF estimated using joint probabilities estimated as the product of marginal}}$$\n\nAnd $-2\\text{log}(\\lambda)$, also follows $\\chi^2$ distribution with certain degrees of freedom. (this sounds like a magic.. to me..)\n\n### Note\n\n-   Both LRT and the Pearson chi-square test generally give similiar result in large samples. (see page 147)\n    -   common criteria $\\frac{\\text{product of marginal counts}}{\\text{total count}} > 1$ or $>5$ for all cells of the contingency table\n\n# Example of Testing Independnece \n\n-   We would like to determine if `bloating severity` is related to the `type of fiber`.\n\n```{r}\ndiet <- read.csv(here(\"data\",\"Fiber.csv\"), stringsAsFactors = TRUE)\n\n# Match order given in table\ndiet$fiber <- factor(x = diet$fiber, levels = c(\"none\", \"bran\", \"gum\", \"both\"))\ndiet$bloat <- factor(x = diet$bloat, levels = c(\"none\", \"low\", \"medium\", \"high\"))\n\ndiet.table <- xtabs(formula = count ~ fiber + bloat, data = diet)\ndiet.table\n```\n\n```{r}\n# Hypothesis tests for independence\nind.test <- chisq.test(x = diet.table, correct = FALSE)\nind.test\n```\n\n-   Note that we include the `correct = FALSE` argument value in `chisq.test()` to prevent a continuity correction from being applied.\n    -   Please see Section 1.2.3 for why we avoid these corrections.\n\n```{r}\nind.test$expected\n```\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"html-math-method":"katex","css":["style.css"],"output-file":"wk4P1.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","title":"Multinomial","editor_options":{"chunk_output_type":"console"},"theme":{"light":"cosmo","dark":["cosmo","theme-dark.scss"]}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}