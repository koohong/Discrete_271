{"title":"Ordinal response regression models","markdown":{"yaml":{"title":"Ordinal response regression models","format":{"html":{"toc":true,"html-math-method":"katex","css":"style.css","theme":{"light":"cosmo","dark":["cosmo","theme-dark.scss"]}}},"execute":{"echo":false},"editor_options":{"chunk_output_type":"console"}},"headingText":"Types of Target","containsRefs":false,"markdown":"\n\n```{=html}\n<style>\n.table-hover > tbody > tr:hover { \n  background-color: #f4f442;\n}\n</style>\n```\n\n```{r message=FALSE, warning=FALSE, include=FALSE}\nlibrary(here)\nsource(here(\"source\",\"get_lib.R\"))\n```\n\n-   Reading\n    -   Ch.3.4\n        -   skip 3.4.3, 3.5 \n\n\n-   In CH1 and 2, the target was binary.\n-   In CH3, target is factor which can be \n    - ordinal (i.e., ordered like Likert scale) or \n    - nominal (i.e., unordered like red and green)\n\n# Nominal response regression models\n\n-   target: red, blue, green (nominal)\n-   recall that odd for binary response was\n\n$$\\text{Odd} = \\frac{\\text{probability of success}}{\\text{probability of failure}}$$\n\n-   We can define odd ratio for multinomial response in a similar way\n\n$$\\text{Odd} = \\frac{\\text{probability of getting red}}{\\text{probability of getting blue}}$$\n\n## Functional form \n\n$$\\text{log}(\\frac{\\text{probility of getting some color}}{\\text{probability of getting blue}}) = \\beta_{\\text{some color }0} + \\beta_{\\text{some color }1}x_1 .. + \\beta_{\\text{some color }p}x_p$$\n\n$$\\text{log}(\\frac{\\pi_j}{\\pi_1}) = \\beta_{j0} + \\beta_{j1}x_1 .. + \\beta_{jp}x_p$$\n\n-   using the multinomial regression model, we can estimate $\\pi_1..\\pi_J$ based on sample, but finding their confidence interval is hard such that we only focus on Wald Confidence interval here.\n\n\n# wheat example\n\n![](image/wheat.PNG){fig-align=\"center\" width=\"400\"}\n\n-   Target is nominal response: `Healthy`, `Sprout` and `Scab`\n\n## EDA\n\n```{r}\n#| echo: true\nwheat <- read.csv(here(\"data\",\"Wheat.csv\"), stringsAsFactors = TRUE)\n\nhrw <- wheat %>% filter(class == \"hrw\")\n\np <- ggparcoord(data = hrw, \n                columns = c(2:6),\n                groupColumn = 7,\n                showPoints = TRUE, \n                title = \"Parallel Coordinate Plot for the Iris Data\",\n                alphaLines = 0.9)\n\nggplotly(p)\n```\n\n## Fit the model \n\n```{r}\n#| echo: false\n#the first is the baseline\nlevels(wheat$type)\n\nmod.fit <- multinom(formula = type ~ class + density + hardness\n+ size + weight + moisture , data = wheat)\n```\n\n## Evaluation\n\n```{r}\nsummary(mod.fit)\n```\n\n- The first parameter `class` has two values `hrw` and `srw`\n- This model output is hard to see. \n\n```{r}\n\n\n# library(equatiomatic)\n# model <- lm(formula = type ~ class + density + hardness\n# + size + weight + moisture , data = wheat)\n# latex_equation <- extract_eq(model)\n# print(latex_equation)\n\n```\n\n-   The estimated coefficient for `classrw`, `-0.648` is part of the following equation\n\n$$\n\\operatorname{log\\frac{\\hat{\\pi}_{scab}}{\\hat{\\pi}_{Healthy}}} = 30.55 -0.65\\cdot(\\operatorname{class}_{\\operatorname{srw}}) + \\beta_{2}(\\operatorname{density}) + \\beta_{3}(\\operatorname{hardness}) + \\beta_{4}(\\operatorname{size}) + \\beta_{5}(\\operatorname{weight}) + \\beta_{6}(\\operatorname{moisture}) + \\hat{\\epsilon}\n$$ \n\n- test statistic is -0.978 and its corresponding p-value is 0.32 - there is not sufficient evidence that hard and soft red winter wheat have different effects on the scab or healthy status of the kernels given the other explanatory variables are in the model\n\n- Let's print the output again. \n\n```{r}\n#using parameter library\na <- model_parameters(mod.fit, digits = 3, p_digits = 3)\n\na[a$Response==\"Scab\",-c(8)] %>% kable(\"html\", caption = \"Scab\") %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"))\n\na[a$Response==\"Sprout\",-c(8)] %>% kable(\"html\", caption = \"Sprout\") %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n### Does anything have any predictive power?\n\n-  So many numbers to keep track of... \n\n![](image/20250515_1714_Comical Cry for Help_simple_compose_01jvb71d92env8p907xwzqr048.png){fig-align=\"center\" width=\"400\"}\n\n\n\n$$H_0: \\beta_{21} = \\beta_{31} = 0$$\n$$H_0: \\beta_{21} \\not = 0 \\text{ and/or } \\beta_{31} \\not= 0$$\n\n### Anova()\n\nAnova() test performs LR test.\n  - LR Chisq is the transformed test statistic related to `class` variable,$-2\\text{log}(\\lambda)=0.964$\n  - Because of the large p-value, there is not sufficient evidence to indicate that the class of wheat is important given that the other variables are in the model.\n  \n```{r}\nAnova(mod.fit) %>% kable(\"html\", caption = \"Anova()\") %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n- Separate tests for `density`, `hardness`, and `weight` in the output all indicate at least marginal evidence of importance for these explanatory variables.\n\n\n```{r}\npi.hat <- predict(object = mod.fit , newdata = wheat , type =\n\"probs\")\n\n##let check the accuracy\nhat_type <- predict(object = mod.fit , newdata = wheat, type = \"class\" )\nresult <- table(hat_type, wheat$type)\n#accuracy\nsum(diag(result))/sum(result)\n```\n\n```{r}\nmod0 <- multinom(formula = type ~ density , data = wheat)\nnew_density <- as.data.frame(seq(0.7,2,by = 0.01))\ncolnames(new_density) <- \"density\"\n\npi_hat <- predict(object = mod0 , newdata = new_density , type =\n\"probs\")\n\np <- cbind(pi_hat,new_density) %>% pivot_longer(-density) %>% \n    ggplot(aes(x=density, y = value, color = name)) + geom_point() +\n    ggtitle(\"If your model had only density in it\")\n\nggplotly(p)\n```\n\n## OR\n\n- The log-odds are modeled directly in a multinomial regression model, odds ratios are useful for interpreting an explanatory variableâ€™s relationship with the response\n\n\n","srcMarkdownNoYaml":"\n\n```{=html}\n<style>\n.table-hover > tbody > tr:hover { \n  background-color: #f4f442;\n}\n</style>\n```\n\n```{r message=FALSE, warning=FALSE, include=FALSE}\nlibrary(here)\nsource(here(\"source\",\"get_lib.R\"))\n```\n\n-   Reading\n    -   Ch.3.4\n        -   skip 3.4.3, 3.5 \n\n# Types of Target\n\n-   In CH1 and 2, the target was binary.\n-   In CH3, target is factor which can be \n    - ordinal (i.e., ordered like Likert scale) or \n    - nominal (i.e., unordered like red and green)\n\n# Nominal response regression models\n\n-   target: red, blue, green (nominal)\n-   recall that odd for binary response was\n\n$$\\text{Odd} = \\frac{\\text{probability of success}}{\\text{probability of failure}}$$\n\n-   We can define odd ratio for multinomial response in a similar way\n\n$$\\text{Odd} = \\frac{\\text{probability of getting red}}{\\text{probability of getting blue}}$$\n\n## Functional form \n\n$$\\text{log}(\\frac{\\text{probility of getting some color}}{\\text{probability of getting blue}}) = \\beta_{\\text{some color }0} + \\beta_{\\text{some color }1}x_1 .. + \\beta_{\\text{some color }p}x_p$$\n\n$$\\text{log}(\\frac{\\pi_j}{\\pi_1}) = \\beta_{j0} + \\beta_{j1}x_1 .. + \\beta_{jp}x_p$$\n\n-   using the multinomial regression model, we can estimate $\\pi_1..\\pi_J$ based on sample, but finding their confidence interval is hard such that we only focus on Wald Confidence interval here.\n\n\n# wheat example\n\n![](image/wheat.PNG){fig-align=\"center\" width=\"400\"}\n\n-   Target is nominal response: `Healthy`, `Sprout` and `Scab`\n\n## EDA\n\n```{r}\n#| echo: true\nwheat <- read.csv(here(\"data\",\"Wheat.csv\"), stringsAsFactors = TRUE)\n\nhrw <- wheat %>% filter(class == \"hrw\")\n\np <- ggparcoord(data = hrw, \n                columns = c(2:6),\n                groupColumn = 7,\n                showPoints = TRUE, \n                title = \"Parallel Coordinate Plot for the Iris Data\",\n                alphaLines = 0.9)\n\nggplotly(p)\n```\n\n## Fit the model \n\n```{r}\n#| echo: false\n#the first is the baseline\nlevels(wheat$type)\n\nmod.fit <- multinom(formula = type ~ class + density + hardness\n+ size + weight + moisture , data = wheat)\n```\n\n## Evaluation\n\n```{r}\nsummary(mod.fit)\n```\n\n- The first parameter `class` has two values `hrw` and `srw`\n- This model output is hard to see. \n\n```{r}\n\n\n# library(equatiomatic)\n# model <- lm(formula = type ~ class + density + hardness\n# + size + weight + moisture , data = wheat)\n# latex_equation <- extract_eq(model)\n# print(latex_equation)\n\n```\n\n-   The estimated coefficient for `classrw`, `-0.648` is part of the following equation\n\n$$\n\\operatorname{log\\frac{\\hat{\\pi}_{scab}}{\\hat{\\pi}_{Healthy}}} = 30.55 -0.65\\cdot(\\operatorname{class}_{\\operatorname{srw}}) + \\beta_{2}(\\operatorname{density}) + \\beta_{3}(\\operatorname{hardness}) + \\beta_{4}(\\operatorname{size}) + \\beta_{5}(\\operatorname{weight}) + \\beta_{6}(\\operatorname{moisture}) + \\hat{\\epsilon}\n$$ \n\n- test statistic is -0.978 and its corresponding p-value is 0.32 - there is not sufficient evidence that hard and soft red winter wheat have different effects on the scab or healthy status of the kernels given the other explanatory variables are in the model\n\n- Let's print the output again. \n\n```{r}\n#using parameter library\na <- model_parameters(mod.fit, digits = 3, p_digits = 3)\n\na[a$Response==\"Scab\",-c(8)] %>% kable(\"html\", caption = \"Scab\") %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"))\n\na[a$Response==\"Sprout\",-c(8)] %>% kable(\"html\", caption = \"Sprout\") %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n### Does anything have any predictive power?\n\n-  So many numbers to keep track of... \n\n![](image/20250515_1714_Comical Cry for Help_simple_compose_01jvb71d92env8p907xwzqr048.png){fig-align=\"center\" width=\"400\"}\n\n\n\n$$H_0: \\beta_{21} = \\beta_{31} = 0$$\n$$H_0: \\beta_{21} \\not = 0 \\text{ and/or } \\beta_{31} \\not= 0$$\n\n### Anova()\n\nAnova() test performs LR test.\n  - LR Chisq is the transformed test statistic related to `class` variable,$-2\\text{log}(\\lambda)=0.964$\n  - Because of the large p-value, there is not sufficient evidence to indicate that the class of wheat is important given that the other variables are in the model.\n  \n```{r}\nAnova(mod.fit) %>% kable(\"html\", caption = \"Anova()\") %>% \n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"))\n```\n\n- Separate tests for `density`, `hardness`, and `weight` in the output all indicate at least marginal evidence of importance for these explanatory variables.\n\n\n```{r}\npi.hat <- predict(object = mod.fit , newdata = wheat , type =\n\"probs\")\n\n##let check the accuracy\nhat_type <- predict(object = mod.fit , newdata = wheat, type = \"class\" )\nresult <- table(hat_type, wheat$type)\n#accuracy\nsum(diag(result))/sum(result)\n```\n\n```{r}\nmod0 <- multinom(formula = type ~ density , data = wheat)\nnew_density <- as.data.frame(seq(0.7,2,by = 0.01))\ncolnames(new_density) <- \"density\"\n\npi_hat <- predict(object = mod0 , newdata = new_density , type =\n\"probs\")\n\np <- cbind(pi_hat,new_density) %>% pivot_longer(-density) %>% \n    ggplot(aes(x=density, y = value, color = name)) + geom_point() +\n    ggtitle(\"If your model had only density in it\")\n\nggplotly(p)\n```\n\n## OR\n\n- The log-odds are modeled directly in a multinomial regression model, odds ratios are useful for interpreting an explanatory variableâ€™s relationship with the response\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"html-math-method":"katex","css":["style.css"],"output-file":"wk4P3.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","title":"Ordinal response regression models","editor_options":{"chunk_output_type":"console"},"theme":{"light":"cosmo","dark":["cosmo","theme-dark.scss"]}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}