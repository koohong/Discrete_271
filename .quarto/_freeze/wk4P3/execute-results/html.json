{
  "hash": "7b2bb2a7fd7c7376e8c62146272f1089",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Ordinal response regression models\"\nformat:\n  html:\n    toc: true\n    html-math-method: katex\n    css: style.css  \n    theme:\n      light: cosmo\n      dark: [cosmo, theme-dark.scss]\nexecute: \n   echo: false\neditor_options: \n  chunk_output_type: console\n---\n\n```{=html}\n<style>\n.table-hover > tbody > tr:hover { \n  background-color: #f4f442;\n}\n</style>\n```\n\n\n\n\n\n\n-   Reading\n    -   Ch.3.4\n        -   skip 3.4.3, 3.5 \n\n# Proportions odds model\n\n- ordinal (i.e., ordered like Likert scale) or \n\n## Functional form \n\n- (p170)\n- The model is the log-odds of cumulative probabilities, called `cumulative logits`\n\n$$\\text{logit}(P(Y \\le j)) = \\text{log}\\frac{P(Y \\le j)}{1-P(Y \\le j)}$$\nIn particular, the `proportional odds model` is assumes the probabilities changes linear as the explanatory variable chagne and the also the slope of this relationship is the same regardless of the category `j`. (see page 170)\n\n\n$$\\text{logit}(P(Y \\le j)) = \\beta_{j0} + \\beta_{1}x_1 .. + \\beta_{p}x_p$$\n- Notice the subscript `j` exists only for the constant term. This is the simplified version of the nominal response model.\n\n- The model assumes that the effects of the explanatory variables are the same regardless of which cumulative probabilities are used to from the `log odds`\n\n- For a fixed `j`, increasing $x_j$ by `c` units changes every log-odds by $c\\beta_r$ when holding other explanatory variables constant.\n\n## Probability \n\n$$\\pi_1 = P(Y \\le 1) - P(Y \\le 0) = \\frac{\\text{exp}(\\beta_{j0} + \\beta_{1}x_1 .. + \\beta_{p}x_p)}{1+\\text{exp}(\\beta_{j0} + \\beta_{1}x_1 .. + \\beta_{p}x_p)}$$\n$$\\pi_J = P(Y \\le J) - P(Y \\le J-1) = \\frac{\\text{exp}(\\beta_{J-1,0} + \\beta_{1}x_1 .. + \\beta_{p}x_p)}{1+\\text{exp}(\\beta_{J-1,0} + \\beta_{1}x_1 .. + \\beta_{p}x_p)}$$\n\n\n# Wheat problem\n\n- Now assuming `scab (Y=1) < sprout (Y=2) < healthy (Y=3)` and fit proportional odds model to the same data\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 275\nColumns: 7\n$ class    <chr> \"hrw\", \"hrw\", \"hrw\", \"hrw\", \"hrw\", \"hrw\", \"hrw\", \"hrw\", \"hrw\"…\n$ density  <dbl> 1.349253, 1.287440, 1.233985, 1.336534, 1.259040, 1.300258, 1…\n$ hardness <dbl> 60.32952, 56.08972, 43.98743, 53.81704, 44.39327, 48.12066, 4…\n$ size     <dbl> 2.30274, 2.72573, 2.51246, 2.27164, 2.35478, 2.49132, 3.06134…\n$ weight   <dbl> 24.6480, 33.2985, 31.7580, 32.7060, 26.0700, 33.2985, 36.4980…\n$ moisture <dbl> 12.01538, 12.17396, 11.87949, 12.11407, 12.06487, 12.18577, 1…\n$ type     <chr> \"Healthy\", \"Healthy\", \"Healthy\", \"Healthy\", \"Healthy\", \"Healt…\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Healthy\" \"Scab\"    \"Sprout\" \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Scab\"    \"Sprout\"  \"Healthy\"\n```\n\n\n:::\n:::\n\n\n\n\n## fit the model \n\n- `method = \"logistic\" in polr()` argument instruct R to use the logit transformation on the cumulative probabilities.\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n$$\n\\begin{aligned}\n\\log\\left[ \\frac { P( \\operatorname{type.order}  \\leq  \\operatorname{Scab} ) }{ 1 - P( \\operatorname{type.order}  \\leq  \\operatorname{Scab} ) } \\right] &= \\alpha_{1} + \\beta_{1}(\\operatorname{class}_{\\operatorname{srw}}) + \\beta_{2}(\\operatorname{density}) + \\beta_{3}(\\operatorname{hardness}) + \\beta_{4}(\\operatorname{size}) + \\beta_{5}(\\operatorname{weight}) + \\beta_{6}(\\operatorname{moisture}) \\\\\n\\log\\left[ \\frac { P( \\operatorname{type.order}  \\leq  \\operatorname{Sprout} ) }{ 1 - P( \\operatorname{type.order}  \\leq  \\operatorname{Sprout} ) } \\right] &= \\alpha_{2} + \\beta_{1}(\\operatorname{class}_{\\operatorname{srw}}) + \\beta_{2}(\\operatorname{density}) + \\beta_{3}(\\operatorname{hardness}) + \\beta_{4}(\\operatorname{size}) + \\beta_{5}(\\operatorname{weight}) + \\beta_{6}(\\operatorname{moisture})\n\\end{aligned}\n$$\n## evaluate\n\n- $\\alpha_1 = 17.57$ and $\\alpha_2 = 20.04$ and their corresponding t-stat are 7.82 and 8.56 respectively.\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n\n```\n\nRe-fitting to get Hessian\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\npolr(formula = type.order ~ class + density + hardness + size + \n    weight + moisture, data = wheat, method = \"logistic\")\n\nCoefficients:\n            Value Std. Error t value\nclasssrw  0.17370   0.391764  0.4434\ndensity  13.50534   1.713009  7.8840\nhardness  0.01039   0.005932  1.7522\nsize     -0.29253   0.413095 -0.7081\nweight    0.12721   0.029996  4.2411\nmoisture -0.03902   0.088396 -0.4414\n\nIntercepts:\n               Value   Std. Error t value\nScab|Sprout    17.5724  2.2460     7.8237\nSprout|Healthy 20.0444  2.3395     8.5677\n\nResidual Deviance: 422.4178 \nAIC: 438.4178 \n```\n\n\n:::\n:::\n\n\n\n\n- density and weight have low `p-value`\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Deviance Table (Type II tests)\n\nResponse: type.order\n         LR Chisq Df Pr(>Chisq)    \nclass       0.197  1    0.65749    \ndensity    98.437  1  < 2.2e-16 ***\nhardness    3.084  1    0.07908 .  \nsize        0.499  1    0.47982    \nweight     18.965  1  1.332e-05 ***\nmoisture    0.195  1    0.65872    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n## predict $\\pi_j$\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n        Scab    Sprout   Healthy\n1 0.03661601 0.2738502 0.6895338\n2 0.03351672 0.2576769 0.7088064\n3 0.08379891 0.4362428 0.4799583\n4 0.01694278 0.1526100 0.8304472\n5 0.11408176 0.4899557 0.3959626\n6 0.02874814 0.2308637 0.7403882\n```\n\n\n:::\n:::\n\n\n\n\n- For finding confidence interval see page 175\n\n## OR\n\n- p175\n- The odds of $Y \\le j$ vs $Y > j$ change by $e^{c\\beta_1}$ times for a `c-unit` increase in $x_1$ while holding the other explanatory variables in the model constant.\n\n- The OR stays the same no matter what response category is used for `j`",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}