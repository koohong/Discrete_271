<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Possion regression – Discrete Response</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>

<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>

<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>

<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Discrete Response</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./wk1.html"> 
<span class="menu-text">Binary groups</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./wk2.html"> 
<span class="menu-text">logit</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./wk4P1.html"> 
<span class="menu-text">Multinomial</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./wk4P2.html"> 
<span class="menu-text">Nominol response regression model</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./wk4P3.html"> 
<span class="menu-text">Ordinal response regression models</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./wk5.html" aria-current="page"> 
<span class="menu-text">Possion regression</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#generalized-linear-models-glm" id="toc-generalized-linear-models-glm" class="nav-link active" data-scroll-target="#generalized-linear-models-glm">Generalized linear models (GLM)</a>
  <ul class="collapse">
  <li><a href="#class-announcements" id="toc-class-announcements" class="nav-link" data-scroll-target="#class-announcements">Class Announcements</a></li>
  <li><a href="#roadmap" id="toc-roadmap" class="nav-link" data-scroll-target="#roadmap">Roadmap</a></li>
  </ul></li>
  <li><a href="#poisson-distribution" id="toc-poisson-distribution" class="nav-link" data-scroll-target="#poisson-distribution">Poisson Distribution</a>
  <ul class="collapse">
  <li><a href="#parameter" id="toc-parameter" class="nav-link" data-scroll-target="#parameter">Parameter</a></li>
  </ul></li>
  <li><a href="#case-study-modeling-the-number-of-awards" id="toc-case-study-modeling-the-number-of-awards" class="nav-link" data-scroll-target="#case-study-modeling-the-number-of-awards">Case Study: Modeling the Number of Awards</a>
  <ul class="collapse">
  <li><a href="#target" id="toc-target" class="nav-link" data-scroll-target="#target">Target</a></li>
  <li><a href="#eda" id="toc-eda" class="nav-link" data-scroll-target="#eda">EDA</a>
  <ul class="collapse">
  <li><a href="#univariate-analysis" id="toc-univariate-analysis" class="nav-link" data-scroll-target="#univariate-analysis">Univariate Analysis</a></li>
  <li><a href="#bivariate-analysis" id="toc-bivariate-analysis" class="nav-link" data-scroll-target="#bivariate-analysis">Bivariate Analysis</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#model-development" id="toc-model-development" class="nav-link" data-scroll-target="#model-development">Model Development</a>
  <ul class="collapse">
  <li><a href="#coefficients" id="toc-coefficients" class="nav-link" data-scroll-target="#coefficients">Coefficients</a>
  <ul class="collapse">
  <li><a href="#anova" id="toc-anova" class="nav-link" data-scroll-target="#anova">Anova()</a></li>
  </ul></li>
  <li><a href="#plot-the-result" id="toc-plot-the-result" class="nav-link" data-scroll-target="#plot-the-result">Plot the result</a></li>
  <li><a href="#ci-of-cofficients" id="toc-ci-of-cofficients" class="nav-link" data-scroll-target="#ci-of-cofficients">CI of cofficients</a></li>
  </ul></li>
  <li><a href="#model-comparison-criteria" id="toc-model-comparison-criteria" class="nav-link" data-scroll-target="#model-comparison-criteria">Model Comparison Criteria</a>
  <ul class="collapse">
  <li><a href="#aic" id="toc-aic" class="nav-link" data-scroll-target="#aic">AIC</a></li>
  <li><a href="#aic_c" id="toc-aic_c" class="nav-link" data-scroll-target="#aic_c">AIC_c</a></li>
  <li><a href="#bic" id="toc-bic" class="nav-link" data-scroll-target="#bic">BIC</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  </ul></li>
  <li><a href="#model-assessment" id="toc-model-assessment" class="nav-link" data-scroll-target="#model-assessment">Model Assessment</a></li>
  <li><a href="#goodness-of-fit" id="toc-goodness-of-fit" class="nav-link" data-scroll-target="#goodness-of-fit">Goodness of Fit</a>
  <ul class="collapse">
  <li><a href="#the-pearson-statistics" id="toc-the-pearson-statistics" class="nav-link" data-scroll-target="#the-pearson-statistics">The Pearson Statistics</a></li>
  <li><a href="#residual-deviance" id="toc-residual-deviance" class="nav-link" data-scroll-target="#residual-deviance">Residual Deviance</a></li>
  </ul></li>
  <li><a href="#directly-testing-for-over-dispersion" id="toc-directly-testing-for-over-dispersion" class="nav-link" data-scroll-target="#directly-testing-for-over-dispersion">Directly Testing for Over Dispersion</a>
  <ul class="collapse">
  <li><a href="#reminders" id="toc-reminders" class="nav-link" data-scroll-target="#reminders">Reminders</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Possion regression</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<style>
.table-hover > tbody > tr:hover { 
  background-color: #f4f442;
}
</style>
<p>Reading - Ch 4.1,4.2.1 - 4.2.3,5.2 - Skim sections 5.1, 5.2.3,5.3,.5.4</p>
<section id="generalized-linear-models-glm" class="level1">
<h1>Generalized linear models (GLM)</h1>
<ul>
<li><p>GLMs have three different parts (see page 121:</p>
<ol type="1">
<li>Random Component:
<ul>
<li><span class="math inline">Y</span>, for logistic regression, <span class="math inline">Y</span> has a Bernoulli distribution</li>
</ul></li>
<li>Systematic Component:
<ul>
<li>This specifies a linear combination of the regression parameters with <code>features</code>, and this part is referred to as the <code>linear predictor</code></li>
<li><span class="math inline">\beta_0 + \beta_1x_1 + .... + \beta_px_p</span></li>
</ul></li>
<li>LINK FUNCTION:
<ul>
<li>Specifies how the expected value of the <code>random component</code> <span class="math inline">E[Y]</span> is linked to the <code>sysmatic</code> component.</li>
<li><span class="math inline">\text{logit}(\pi) = \beta_0 + \beta_1x_1 + .... + \beta_px_p</span></li>
<li>where <span class="math inline">E[Y] = \pi</span></li>
</ul></li>
</ol></li>
</ul>
<section id="class-announcements" class="level2">
<h2 class="anchored" data-anchor-id="class-announcements">Class Announcements</h2>
<p>No HW this week</p>
<p>Lab-1 due in 1 week</p>
</section>
<section id="roadmap" class="level2">
<h2 class="anchored" data-anchor-id="roadmap">Roadmap</h2>
<p><strong>Rearview Mirror</strong></p>
<ul>
<li>Model unordered and ordered categorical response</li>
</ul>
<p><strong>Today</strong></p>
<ul>
<li><p>Poisson probability model</p></li>
<li><p>Poisson regression model, estimation, and statistical inference</p></li>
<li><p>Model Comparison Criteria, Model Assessment, Goodness of Fit</p></li>
</ul>
<p><strong>Looking Ahead</strong></p>
<ul>
<li><p>Univariate and multivariate time-series</p></li>
<li><p>Notion of dependency and stationarity</p></li>
</ul>
</section>
</section>
<section id="poisson-distribution" class="level1">
<h1>Poisson Distribution</h1>
<p>Recall that the Poisson distribution models count data i.e.&nbsp;the number of events between 0,1,… for a random variable <span class="math inline">X</span>. The distribution is:</p>
<p><span class="math display">P(X=k)=\frac{\lambda^ke^{-\lambda}}{k!}</span> One key assumption of the distribution is that <span class="math inline">E(X)=Var(X)=\lambda</span>, meaning that the mean and variance of the distribution is the same.</p>
<p>As we will see this is a limiting assumption when we do Poisson Regression.</p>
<p>In Poisson regression we model the log of <span class="math inline">\lambda</span> (the mean assuming a Poisson distribution) as a linear combination of the features:</p>
<p><span class="math display">\text{log}(\lambda_i)=\text{log}(E(Y_i|X_i))=X_i\beta</span></p>
<p>We use maximum likelihood to estimate the coefficients in <span class="math inline">\beta</span> assuming that <span class="math inline">Y</span> follows an iid Poisson distribution:</p>
<p><span class="math display">max_\beta\ L(\beta|Y_1,...,Y_n)=P(Y_1=y_1,...,Y_n=y_n|\beta)=\Pi_i\frac{e^{y_iX_i\beta}e^{-e^{X_i\beta}}}{y_i!}</span></p>
<p>The log likelihood has no closed form solution, so we estimate the parameters beta using numerical methods just like in logistic regression.</p>
<p>For each <span class="math inline">y_i</span> we can calculate and predict fitted values using the MLE of the coefficients:</p>
<p><span class="math display">\hat{y_i}=E(y_i|X_i)=\lambda_i=e^{X_i\beta}</span> Under Poisson regression, the <span class="math inline">\text{V}[\hat{y_i}]=\lambda_i=e^{X_i\beta}</span> so that Poisson regression naturally has heteroskedasticity in the results.</p>
<p>Because coefficients are linear on the log scale, when exponentiated they multiply the expected mean outcome. This is similar to the interpretation in logistic regression except we are not dealing with odds ratios but rather changes in the average outcome.</p>
<section id="parameter" class="level2">
<h2 class="anchored" data-anchor-id="parameter">Parameter</h2>
<p>Equal Mean and Variance and Overdispersion</p>
<p>This assumption of equal mean and variance is often not met when actually fitting to data, which results in what is known as overdispersion where the variance in the data is larger than the variance fit in the model.</p>
<p>This usually can be remedied by adding more <span class="math inline">X</span> variables into the model to improve the fit.</p>
<p>Another option is to fit what are known as a quasi poisson model or negative binomial regression model. In both cases, we relax the equal mean and variance assumption by adding an additional parameter to the variance of the response variable, allowing it to be larger than the mean.</p>
<p>In quasi poisson regression we set $</p>
<p><span class="math display">\text{V}[\hat{y_i}]=\theta\lambda_i</span> and in negative binomial regression we set</p>
<p><span class="math display">\text{V}[\hat{y_i}]=\lambda_i+\kappa\lambda_i^2</span></p>
</section>
</section>
<section id="case-study-modeling-the-number-of-awards" class="level1">
<h1>Case Study: Modeling the Number of Awards</h1>
<section id="target" class="level2">
<h2 class="anchored" data-anchor-id="target">Target</h2>
<ul>
<li><code>The number of awards</code> earned by students based on the <code>type of programs students were enrolled</code> in using historical admission data.</li>
<li><code>num_awards</code>: the number of awards earned by students at a high school in a year</li>
<li><code>math</code>: students’ scores on their final math exam</li>
<li><code>prog</code>: the type of program in which the students were enrolled
<ul>
<li><code>1 = General</code></li>
<li><code>2 = Academic</code></li>
<li><code>3 = Vocational</code></li>
</ul></li>
</ul>
</section>
<section id="eda" class="level2">
<h2 class="anchored" data-anchor-id="eda">EDA</h2>
<ul>
<li>What is the number of observations?</li>
<li>What is the number of variables?</li>
<li>Are there any redundant variables?</li>
<li>Are there any missing information?</li>
<li>Are there any duplicated records?</li>
<li>Are there any values in each of the variables that seem unreasonable?</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Modeling the Number of Awards</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">X</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">num_awards</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">prog</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">math</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Vocational</td>
<td style="text-align: right;">41</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">General</td>
<td style="text-align: right;">41</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Vocational</td>
<td style="text-align: right;">44</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Vocational</td>
<td style="text-align: right;">42</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">153</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Vocational</td>
<td style="text-align: right;">40</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">General</td>
<td style="text-align: right;">42</td>
</tr>
</tbody>
</table>


</div>
<div class="cell-output cell-output-stdout">
<pre><code>         X         id num_awards       prog       math 
         0          0          0          0          0 </code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
<section id="univariate-analysis" class="level3">
<h3 class="anchored" data-anchor-id="univariate-analysis">Univariate Analysis</h3>
<ul>
<li>Use a frequency table and a bar plot to explore the distribution of the response variable(num_awards). What do you learn?</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Modeling the Number of Awards</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Number of awards</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">N</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">0.62</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">0.24</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0.06</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.00</td>
</tr>
</tbody>
</table>


</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..prop..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(prop)` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wk5_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>The prog is the committee’s key explanatory variable of interest. It has three levels: academic, general, and vocational. Use a frequency table and a bar plot to examine its distribution. What do you discover?</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Modeling the Number of Awards</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Type of program</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">N</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Academic</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">0.52</td>
</tr>
<tr class="even">
<td style="text-align: left;">General</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">0.22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Vocational</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">0.25</td>
</tr>
</tbody>
</table>


</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wk5_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Plot the distribution of math scores. What are the range and average math scores?</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wk5_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bivariate-analysis" class="level3">
<h3 class="anchored" data-anchor-id="bivariate-analysis">Bivariate Analysis</h3>
<ul>
<li><p>Examine the associations between the number of awards and program and math scores.</p></li>
<li><p>The graph below shows the distribution of the number of awards by program types. How are awards distributed among different programs?</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wk5_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>The graph below shows the distribution of the number of awards and students’ math scores. Is there any clear relationship between them?</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wk5_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Use summary_factorlist() function from the finalfit package to tabulate data. What do you learn from the EDA?</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Modeling the Number of Awards</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Dependent: num_awards</th>
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">unit</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">prog</td>
<td style="text-align: left;">Academic</td>
<td style="text-align: left;">Mean (sd)</td>
<td style="text-align: left;">1.0 (1.3)</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">General</td>
<td style="text-align: left;">Mean (sd)</td>
<td style="text-align: left;">0.2 (0.4)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Vocational</td>
<td style="text-align: left;">Mean (sd)</td>
<td style="text-align: left;">0.2 (0.5)</td>
</tr>
<tr class="even">
<td style="text-align: left;">math</td>
<td style="text-align: left;">[33.0,75.0]</td>
<td style="text-align: left;">Mean (sd)</td>
<td style="text-align: left;">0.6 (1.1)</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
</section>
<section id="model-development" class="level1">
<h1>Model Development</h1>
<ul>
<li>Given the specification of a poisson regression model below,</li>
</ul>
<p><span class="math display">\log(mean\_num\_awards) = \beta_0 + \beta_1 prog + \beta_2 math + u</span></p>
<ul>
<li>Estimate and interpret the model results using <code>glm()</code> and the correct <code>family</code> parameter:</li>
</ul>
<section id="coefficients" class="level2">
<h2 class="anchored" data-anchor-id="coefficients">Coefficients</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>poisson.mod<span class="fl">.1</span> <span class="ot">&lt;-</span> poisson.mod<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(num_awards <span class="sc">~</span> prog <span class="sc">+</span> math, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">data =</span> df, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">family =</span> poisson)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(poisson.mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = num_awards ~ prog + math, family = poisson, data = df)

Coefficients:
               Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    -4.16327    0.66288  -6.281 3.37e-10 ***
progGeneral    -1.08386    0.35825  -3.025  0.00248 ** 
progVocational -0.71405    0.32001  -2.231  0.02566 *  
math            0.07015    0.01060   6.619 3.63e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 287.67  on 199  degrees of freedom
Residual deviance: 189.45  on 196  degrees of freedom
AIC: 373.5

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<ul>
<li><p>The <code>negative coefficients</code> of the <code>general</code> and <code>vocational programs</code> indicate that the number of wards is lower in these two programs.</p></li>
<li><p>The positive coefficients of <code>math</code> score indicates that the number of awards is increasing as the math score increases.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">exp</span>(<span class="fu">coef</span>(poisson.mod<span class="fl">.1</span>)) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept)    progGeneral progVocational           math 
    -98.444332     -66.171250     -51.034289       7.267164 </code></pre>
</div>
</div>
<p>To have a more convenient way to interpret these coefficients, we compute and use percentage changes - Holding <code>program type constant</code>, 1 unit increase in math score increase the mean number of awards by 7%.</p>
<ul>
<li>Hold <code>math score constant</code>;
<ul>
<li>a student in the <code>general program</code>, on average, receives 66% fewer awards than students in the <code>academic program</code></li>
<li>a student in the <code>vocational program</code>, on average, receives 51% fewer awards than students in the academic program</li>
</ul></li>
</ul>
<section id="anova" class="level3">
<h3 class="anchored" data-anchor-id="anova">Anova()</h3>
<ul>
<li>Test the overall effect of prog using <code>Anova()</code>:</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: num_awards
     LR Chisq Df Pr(&gt;Chisq)    
prog   14.572  2  0.0006852 ***
math   45.010  1   1.96e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li>Based on the p-values, the prog, taken together, is a statistically significant predictor of the number of awards.</li>
</ul>
</section>
</section>
<section id="plot-the-result" class="level2">
<h2 class="anchored" data-anchor-id="plot-the-result">Plot the result</h2>
<ul>
<li>Plot the fitted values across the three programs and discuss how the number of awards is associated with math scores.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-cd6df1a2bf85641baa9e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-cd6df1a2bf85641baa9e">{"x":{"data":[{"x":[38.01586435493082,44.667942989245056,42.899628448300064,48.731948816962543,46.354547948390248,40.981175755336878,43.272647850774227,49.136882030963896,41.874573986046016,40.736689283698794,50.020923390612005,44.274311245977877,51.804059005901216,48.002005312778053,44.702642448805271,49.845250135660173,43.056060531176627,54.224967377074066,45.024218992143872,43.231311969645319,49.19070502743125,53.058183955214915,49.628447346575555,47.854984366521236,50.946761957183483,45.107805573381484,53.631842180341479,51.344087356142701,52.788459151983261,50.243031077273187,56.902666941098872,51.237165350653228,48.817592543177305,48.375408662296834,51.977489039115611,53.269985958375038,59.271039254777136,66.112707202322781,57.326902300678192,54.062880971282723,53.698063265532255,53.857729434035718,54.016186277754606,48.801439363323155,58.27563511263579,59.982663402333856,51.302120793610811,62.624254539422694,50.339388904720543,52.875345080718397,52.691904920712112,54.973070429638028,56.282501717284319,48.639781390503046,60.877424372546372,57.035188709571955,66.096867100894457,59.668633888103066,57.381112602911891,59.231563715822993,58.19693942479789,57.161115951649847,63.934855577722189,61.13101552389562,55.128055628575382,56.824239153414965,61.716988511756064,55.81090696565807,50.847968015447258,63.064952661655845,60.836141880415383,67.120135211385787,48.159330639615654,61.395041495189069,65.138156635314232,62.169022526592016,61.040030344575641,63.898238548077643,65.247352400235826,56.999332493916157,72.154677088372409,62.114472831785676,58.084081098251048,63.299987142160532,63.995802341960371,71.748332071863118,63.707188479416075,69.077701314724976,70.010362645052368,65.984427117183799,61.921252756565806,67.373145820945496,63.691927807964383,63.245785421319304,67.941967334784565,74.610359229333696,69.106555748172099,65.122093525156373,70.99340956732631,70.85659051891416,60.211813932284713,70.891418315283957,71.169578156620261,72.01154403667897,73.090515052899718],"y":[0.091385873220860947,-0.15124043161049486,-0.14412905983626845,0.0075795899145305046,0.065927611663937569,1.0787724326364696,1.1667022339068354,-0.18616867801174522,0.077658043429255474,0.072879435960203409,-0.1662585566751659,0.077785705402493466,-0.11961921555921436,0.89312563203275208,0.17666374118998646,2.80469360826537,-0.13495952412486079,0.8336020057089627,1.1005885882303119,-0.074729344435036177,0.041645347420126211,0.91275204112753272,1.9073486797511578,0.11256686458364129,0.17398151475936174,-0.13117717541754248,0.1870822231285274,0.89506966648623343,-0.0036443020217120647,-0.0030214508995413669,1.0813109422102571,0.086987907439470269,0.055561944656074058,0.1482102098874748,-0.14570032684132458,1.0766303052194417,0.9993055699393153,2.0014195987023413,0.13640890121459964,1.0583132055588067,1.1896942117251457,-0.14867487493902445,-0.11612233966588975,1.9766577961854637,3.1270448165945708,0.88730572583153844,-0.042965366039425135,-0.095780323445796969,0.84841369474306705,1.071047521661967,0.083200250007212151,0.16089157173410057,0.86933039892464881,-0.024072291515767563,1.1504303987137974,-0.078556359186768537,-0.18375300047919155,2.891701219137758,1.0741565963253379,-0.075246363133192065,0.11581823565065863,0.037204425781965256,3.1386818022467198,1.0181041521020233,0.059291952196508624,2.9475696656852959,-0.024718957953155041,0.11152376476675274,-0.19641482755541803,1.1733938579447567,5.0745836716145281,0.013743921089917427,0.12689792625606061,0.82322934977710249,1.9450213683769106,4.0060077084228398,0.90783591186627743,1.1568151200190187,2.8836736235767604,3.1635185148566962,2.1485675536096096,-0.18663562098518016,0.81494034258648751,1.1053837710060179,2.8622522608377041,1.9400214066728949,-0.13840074436739089,6.0569043966010216,3.839735028333962,1.0504234440624713,1.9084266969934105,1.8319795800372958,1.0786986907012761,2.137746804766357,1.1167602343484759,0.81008876617997883,-0.0074790841899812222,0.84327527265995739,1.8918305295519531,4.8548494893126186,0.94895541360601787,1.8456295453943312,0.86089790156111123,-0.14525801865383983,2.8653204509988428],"text":["math: 38<br />num_awards: 0<br />prog: Academic","math: 45<br />num_awards: 0<br />prog: Academic","math: 43<br />num_awards: 0<br />prog: Academic","math: 49<br />num_awards: 0<br />prog: Academic","math: 46<br />num_awards: 0<br />prog: Academic","math: 41<br />num_awards: 1<br />prog: Academic","math: 43<br />num_awards: 1<br />prog: Academic","math: 49<br />num_awards: 0<br />prog: Academic","math: 42<br />num_awards: 0<br />prog: Academic","math: 41<br />num_awards: 0<br />prog: Academic","math: 50<br />num_awards: 0<br />prog: Academic","math: 44<br />num_awards: 0<br />prog: Academic","math: 52<br />num_awards: 0<br />prog: Academic","math: 48<br />num_awards: 1<br />prog: Academic","math: 45<br />num_awards: 0<br />prog: Academic","math: 50<br />num_awards: 3<br />prog: Academic","math: 43<br />num_awards: 0<br />prog: Academic","math: 54<br />num_awards: 1<br />prog: Academic","math: 45<br />num_awards: 1<br />prog: Academic","math: 43<br />num_awards: 0<br />prog: Academic","math: 49<br />num_awards: 0<br />prog: Academic","math: 53<br />num_awards: 1<br />prog: Academic","math: 50<br />num_awards: 2<br />prog: Academic","math: 48<br />num_awards: 0<br />prog: Academic","math: 51<br />num_awards: 0<br />prog: Academic","math: 45<br />num_awards: 0<br />prog: Academic","math: 54<br />num_awards: 0<br />prog: Academic","math: 51<br />num_awards: 1<br />prog: Academic","math: 53<br />num_awards: 0<br />prog: Academic","math: 50<br />num_awards: 0<br />prog: Academic","math: 57<br />num_awards: 1<br />prog: Academic","math: 51<br />num_awards: 0<br />prog: Academic","math: 49<br />num_awards: 0<br />prog: Academic","math: 48<br />num_awards: 0<br />prog: Academic","math: 52<br />num_awards: 0<br />prog: Academic","math: 53<br />num_awards: 1<br />prog: Academic","math: 59<br />num_awards: 1<br />prog: Academic","math: 66<br />num_awards: 2<br />prog: Academic","math: 57<br />num_awards: 0<br />prog: Academic","math: 54<br />num_awards: 1<br />prog: Academic","math: 54<br />num_awards: 1<br />prog: Academic","math: 54<br />num_awards: 0<br />prog: Academic","math: 54<br />num_awards: 0<br />prog: Academic","math: 49<br />num_awards: 2<br />prog: Academic","math: 58<br />num_awards: 3<br />prog: Academic","math: 60<br />num_awards: 1<br />prog: Academic","math: 51<br />num_awards: 0<br />prog: Academic","math: 63<br />num_awards: 0<br />prog: Academic","math: 50<br />num_awards: 1<br />prog: Academic","math: 53<br />num_awards: 1<br />prog: Academic","math: 53<br />num_awards: 0<br />prog: Academic","math: 55<br />num_awards: 0<br />prog: Academic","math: 56<br />num_awards: 1<br />prog: Academic","math: 49<br />num_awards: 0<br />prog: Academic","math: 61<br />num_awards: 1<br />prog: Academic","math: 57<br />num_awards: 0<br />prog: Academic","math: 66<br />num_awards: 0<br />prog: Academic","math: 60<br />num_awards: 3<br />prog: Academic","math: 57<br />num_awards: 1<br />prog: Academic","math: 59<br />num_awards: 0<br />prog: Academic","math: 58<br />num_awards: 0<br />prog: Academic","math: 57<br />num_awards: 0<br />prog: Academic","math: 64<br />num_awards: 3<br />prog: Academic","math: 61<br />num_awards: 1<br />prog: Academic","math: 55<br />num_awards: 0<br />prog: Academic","math: 57<br />num_awards: 3<br />prog: Academic","math: 62<br />num_awards: 0<br />prog: Academic","math: 56<br />num_awards: 0<br />prog: Academic","math: 51<br />num_awards: 0<br />prog: Academic","math: 63<br />num_awards: 1<br />prog: Academic","math: 61<br />num_awards: 5<br />prog: Academic","math: 67<br />num_awards: 0<br />prog: Academic","math: 48<br />num_awards: 0<br />prog: Academic","math: 61<br />num_awards: 1<br />prog: Academic","math: 65<br />num_awards: 2<br />prog: Academic","math: 62<br />num_awards: 4<br />prog: Academic","math: 61<br />num_awards: 1<br />prog: Academic","math: 64<br />num_awards: 1<br />prog: Academic","math: 65<br />num_awards: 3<br />prog: Academic","math: 57<br />num_awards: 3<br />prog: Academic","math: 72<br />num_awards: 2<br />prog: Academic","math: 62<br />num_awards: 0<br />prog: Academic","math: 58<br />num_awards: 1<br />prog: Academic","math: 63<br />num_awards: 1<br />prog: Academic","math: 64<br />num_awards: 3<br />prog: Academic","math: 72<br />num_awards: 2<br />prog: Academic","math: 64<br />num_awards: 0<br />prog: Academic","math: 69<br />num_awards: 6<br />prog: Academic","math: 70<br />num_awards: 4<br />prog: Academic","math: 66<br />num_awards: 1<br />prog: Academic","math: 62<br />num_awards: 2<br />prog: Academic","math: 67<br />num_awards: 2<br />prog: Academic","math: 64<br />num_awards: 1<br />prog: Academic","math: 63<br />num_awards: 2<br />prog: Academic","math: 68<br />num_awards: 1<br />prog: Academic","math: 75<br />num_awards: 1<br />prog: Academic","math: 69<br />num_awards: 0<br />prog: Academic","math: 65<br />num_awards: 1<br />prog: Academic","math: 71<br />num_awards: 2<br />prog: Academic","math: 71<br />num_awards: 5<br />prog: Academic","math: 60<br />num_awards: 1<br />prog: Academic","math: 71<br />num_awards: 2<br />prog: Academic","math: 71<br />num_awards: 1<br />prog: Academic","math: 72<br />num_awards: 0<br />prog: Academic","math: 73<br />num_awards: 3<br />prog: Academic"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":0.5,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Academic","legendgroup":"Academic","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[40.759107198379937,42.069660862721506,38.975765164755288,42.723131847940387,41.766531938500705,44.190003795176743,45.76712923273444,42.26105981413275,43.093535942398013,56.810163993202153,38.758330977335575,45.94799527581781,43.001195125095549,42.030813374556601,53.774899063631892,44.867324098013341,53.856984397955237,41.367138422653078,46.041826416924593,45.827335633337498,60.942762085609139,48.79786507356912,48.624572868086396,57.164604944176972,42.198703785985707,55.105982745438816,51.996001479402182,56.894601185992357,34.660487625189127,49.920343166589738,55.088397605158391,49.138380400091407,55.828193262778221,59.653131577000025,53.696732845902446,58.223233704268935,55.832448604889215,59.675134606286882,60.968626793846489,56.79082939811051,48.070609464123848,57.73572786170989,55.951796525530519,63.244220117107034,58.254811226204041],"y":[0.15933657735586165,0.16083305701613426,0.022153700795024628,0.16658512651920321,-0.12716432316228748,1.1906856821849943,0.9615093527361751,-0.097738763876259335,0.11093898061662916,0.14373009596019987,-0.10200807694345713,-0.071323411073535681,-0.085710118059068918,0.9033623442985117,-0.077980424650013452,-0.018854424729943281,0.061487628612667322,0.0017932705581188146,-0.14948707735165956,-0.080876029003411537,0.13946290761232377,-0.03698267536237837,0.88924847291782494,-0.12040006006136537,0.071204189769923709,-0.054499659687280655,-0.14041396621614696,-0.13628245983272791,0.133133037481457,-0.023730112239718437,1.0119834597222508,0.037767105735838413,-0.13238379424437879,-0.028116502054035653,0.00037680435925721567,0.83512291479855771,-0.026109284069389116,-0.046284607518464332,-0.18210394699126484,0.057350494991987966,-0.16442610993981363,0.90711020464077596,0.96897440068423746,1.0512220025993884,-0.070547496713697921],"text":["math: 41<br />num_awards: 0<br />prog: General","math: 42<br />num_awards: 0<br />prog: General","math: 39<br />num_awards: 0<br />prog: General","math: 43<br />num_awards: 0<br />prog: General","math: 42<br />num_awards: 0<br />prog: General","math: 44<br />num_awards: 1<br />prog: General","math: 46<br />num_awards: 1<br />prog: General","math: 42<br />num_awards: 0<br />prog: General","math: 43<br />num_awards: 0<br />prog: General","math: 57<br />num_awards: 0<br />prog: General","math: 39<br />num_awards: 0<br />prog: General","math: 46<br />num_awards: 0<br />prog: General","math: 43<br />num_awards: 0<br />prog: General","math: 42<br />num_awards: 1<br />prog: General","math: 54<br />num_awards: 0<br />prog: General","math: 45<br />num_awards: 0<br />prog: General","math: 54<br />num_awards: 0<br />prog: General","math: 41<br />num_awards: 0<br />prog: General","math: 46<br />num_awards: 0<br />prog: General","math: 46<br />num_awards: 0<br />prog: General","math: 61<br />num_awards: 0<br />prog: General","math: 49<br />num_awards: 0<br />prog: General","math: 49<br />num_awards: 1<br />prog: General","math: 57<br />num_awards: 0<br />prog: General","math: 42<br />num_awards: 0<br />prog: General","math: 55<br />num_awards: 0<br />prog: General","math: 52<br />num_awards: 0<br />prog: General","math: 57<br />num_awards: 0<br />prog: General","math: 35<br />num_awards: 0<br />prog: General","math: 50<br />num_awards: 0<br />prog: General","math: 55<br />num_awards: 1<br />prog: General","math: 49<br />num_awards: 0<br />prog: General","math: 56<br />num_awards: 0<br />prog: General","math: 60<br />num_awards: 0<br />prog: General","math: 54<br />num_awards: 0<br />prog: General","math: 58<br />num_awards: 1<br />prog: General","math: 56<br />num_awards: 0<br />prog: General","math: 60<br />num_awards: 0<br />prog: General","math: 61<br />num_awards: 0<br />prog: General","math: 57<br />num_awards: 0<br />prog: General","math: 48<br />num_awards: 0<br />prog: General","math: 58<br />num_awards: 1<br />prog: General","math: 56<br />num_awards: 1<br />prog: General","math: 63<br />num_awards: 1<br />prog: General","math: 58<br />num_awards: 0<br />prog: General"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","opacity":0.5,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,186,56,1)"}},"hoveron":"points","name":"General","legendgroup":"General","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[41.262477544136345,44.336365615949035,42.182675864361229,39.68795490376651,46.329984799958766,39.913240873254836,32.74349035676569,46.211174944043158,39.667249418795109,43.946811515837908,36.728567958995697,40.277032393217084,38.315284699201584,39.172779715619981,45.306071051955222,40.336106233298779,40.124327303655448,47.10553994625807,40.012518581561743,38.781998492032287,48.867160004004838,38.883808450773358,41.312506613694133,39.05298563428223,52.369198919646443,39.669734592363241,45.075033450126647,47.114648388512435,39.781170613318679,52.013529530540112,51.657945890724662,51.277815527282655,55.240136778354646,54.351567041687666,55.905404490046202,45.917045440711078,44.822943398356436,47.123065619356929,40.699938913807273,53.393416245467961,50.684995665028694,40.230987686291336,49.625469382107255,56.919663312099871,57.069677209481597,51.270657089911403,56.055044685676691,52.934232535958287,66.096101196669039,74.819472689367828],"y":[0.14340692749246958,-0.12510715890675783,-0.15616776132956148,-0.10494645508006216,-0.17440742580220103,-0.058406907040625816,0.18334734411910175,0.090855526179075219,-0.16939114555716517,0.15418766131624578,-0.066855407226830726,-0.11401543440297246,-0.08692050157114864,0.18857779232785105,-0.010982822254300112,-0.17682048566639424,0.17700610626488927,-0.097764362487941986,1.1686864221468567,1.0030654355883599,-0.17566079106181862,0.13932320280000571,1.0358185826800763,0.083968978095799673,-0.030325345136225229,0.049143403116613638,0.095726549718529008,0.0068037663586437702,1.1335801428183914,0.042849573493003834,1.005863153282553,0.84698719885200258,-0.025125885289162403,0.047291573975235229,-0.12034795619547367,-0.020818094257265329,-0.025276067294180388,0.077323596365749814,-0.035491923149675142,0.045678631961345667,1.0103659231215716,-0.1153837736696005,-0.082033937238156801,0.047933022119104857,-0.14215277181938291,1.1586859566159546,1.9690724413841962,0.066738403122872103,0.19463476892560722,1.8753003840334714],"text":["math: 41<br />num_awards: 0<br />prog: Vocational","math: 44<br />num_awards: 0<br />prog: Vocational","math: 42<br />num_awards: 0<br />prog: Vocational","math: 40<br />num_awards: 0<br />prog: Vocational","math: 46<br />num_awards: 0<br />prog: Vocational","math: 40<br />num_awards: 0<br />prog: Vocational","math: 33<br />num_awards: 0<br />prog: Vocational","math: 46<br />num_awards: 0<br />prog: Vocational","math: 40<br />num_awards: 0<br />prog: Vocational","math: 44<br />num_awards: 0<br />prog: Vocational","math: 37<br />num_awards: 0<br />prog: Vocational","math: 40<br />num_awards: 0<br />prog: Vocational","math: 38<br />num_awards: 0<br />prog: Vocational","math: 39<br />num_awards: 0<br />prog: Vocational","math: 45<br />num_awards: 0<br />prog: Vocational","math: 40<br />num_awards: 0<br />prog: Vocational","math: 40<br />num_awards: 0<br />prog: Vocational","math: 47<br />num_awards: 0<br />prog: Vocational","math: 40<br />num_awards: 1<br />prog: Vocational","math: 39<br />num_awards: 1<br />prog: Vocational","math: 49<br />num_awards: 0<br />prog: Vocational","math: 39<br />num_awards: 0<br />prog: Vocational","math: 41<br />num_awards: 1<br />prog: Vocational","math: 39<br />num_awards: 0<br />prog: Vocational","math: 52<br />num_awards: 0<br />prog: Vocational","math: 40<br />num_awards: 0<br />prog: Vocational","math: 45<br />num_awards: 0<br />prog: Vocational","math: 47<br />num_awards: 0<br />prog: Vocational","math: 40<br />num_awards: 1<br />prog: Vocational","math: 52<br />num_awards: 0<br />prog: Vocational","math: 52<br />num_awards: 1<br />prog: Vocational","math: 51<br />num_awards: 1<br />prog: Vocational","math: 55<br />num_awards: 0<br />prog: Vocational","math: 54<br />num_awards: 0<br />prog: Vocational","math: 56<br />num_awards: 0<br />prog: Vocational","math: 46<br />num_awards: 0<br />prog: Vocational","math: 45<br />num_awards: 0<br />prog: Vocational","math: 47<br />num_awards: 0<br />prog: Vocational","math: 41<br />num_awards: 0<br />prog: Vocational","math: 53<br />num_awards: 0<br />prog: Vocational","math: 51<br />num_awards: 1<br />prog: Vocational","math: 40<br />num_awards: 0<br />prog: Vocational","math: 50<br />num_awards: 0<br />prog: Vocational","math: 57<br />num_awards: 0<br />prog: Vocational","math: 57<br />num_awards: 0<br />prog: Vocational","math: 51<br />num_awards: 1<br />prog: Vocational","math: 56<br />num_awards: 2<br />prog: Vocational","math: 53<br />num_awards: 0<br />prog: Vocational","math: 66<br />num_awards: 0<br />prog: Vocational","math: 75<br />num_awards: 2<br />prog: Vocational"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","opacity":0.5,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(97,156,255,1)"}},"hoveron":"points","name":"Vocational","legendgroup":"Vocational","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[38,41,41,42,43,43,43,43,44,45,45,45,45,46,48,48,48,48,49,49,49,49,49,49,50,50,50,50,50,51,51,51,51,51,52,52,53,53,53,53,53,54,54,54,54,54,54,55,55,56,56,57,57,57,57,57,57,57,58,58,58,59,59,60,60,60,61,61,61,61,61,62,62,62,62,63,63,63,63,64,64,64,64,64,65,65,65,66,66,66,67,67,68,69,69,70,71,71,71,71,72,72,72,73,75],"y":[0.22369446625155492,0.27609315401160389,0.27609315401160389,0.2961572966565304,0.31767953347810218,0.31767953347810218,0.31767953347810218,0.31767953347810218,0.34076582657325966,0.36552983847844006,0.36552983847844006,0.36552983847844006,0.36552983847844006,0.39209349177315406,0.45115235831258804,0.45115235831258804,0.45115235831258804,0.45115235831258804,0.48393834065316543,0.48393834065316543,0.48393834065316543,0.48393834065316543,0.48393834065316543,0.48393834065316543,0.51910693414102149,0.51910693414102149,0.51910693414102149,0.51910693414102149,0.51910693414102149,0.55683128703873264,0.55683128703873264,0.55683128703873264,0.55683128703873264,0.55683128703873264,0.59729713057729994,0.59729713057729994,0.64070369338111566,0.64070369338111566,0.64070369338111566,0.64070369338111566,0.64070369338111566,0.68726468234569404,0.68726468234569404,0.68726468234569404,0.68726468234569404,0.68726468234569404,0.68726468234569404,0.73720933479739725,0.73720933479739725,0.7907835471153335,0.7907835471153335,0.84825108537206273,0.84825108537206273,0.84825108537206273,0.84825108537206273,0.84825108537206273,0.84825108537206273,0.84825108537206273,0.90989488395355023,0.90989488395355023,0.90989488395355023,0.97601843855195747,0.97601843855195747,1.0469473003895158,1.0469473003895158,1.0469473003895158,1.123030679030093,1.123030679030093,1.123030679030093,1.123030679030093,1.123030679030093,1.2046431616697071,1.2046431616697071,1.2046431616697071,1.2046431616697071,1.2921865573707123,1.2921865573707123,1.2921865573707123,1.2921865573707123,1.3860918753194964,1.3860918753194964,1.3860918753194964,1.3860918753194964,1.3860918753194964,1.4868214468474272,1.4868214468474272,1.4868214468474272,1.5948712016625326,1.5948712016625326,1.5948712016625326,1.7107731094986729,1.7107731094986729,1.8350977992033781,1.9684573681590776,1.9684573681590776,2.1115083958696022,2.2649551765489493,2.2649551765489493,2.2649551765489493,2.2649551765489493,2.4295531866275786,2.4295531866275786,2.4295531866275786,2.6061128042480974,2.9986571119762258],"text":["math: 38<br />fitted_values: 0.22369447<br />prog: Academic","math: 41<br />fitted_values: 0.27609315<br />prog: Academic","math: 41<br />fitted_values: 0.27609315<br />prog: Academic","math: 42<br />fitted_values: 0.29615730<br />prog: Academic","math: 43<br />fitted_values: 0.31767953<br />prog: Academic","math: 43<br />fitted_values: 0.31767953<br />prog: Academic","math: 43<br />fitted_values: 0.31767953<br />prog: Academic","math: 43<br />fitted_values: 0.31767953<br />prog: Academic","math: 44<br />fitted_values: 0.34076583<br />prog: Academic","math: 45<br />fitted_values: 0.36552984<br />prog: Academic","math: 45<br />fitted_values: 0.36552984<br />prog: Academic","math: 45<br />fitted_values: 0.36552984<br />prog: Academic","math: 45<br />fitted_values: 0.36552984<br />prog: Academic","math: 46<br />fitted_values: 0.39209349<br />prog: Academic","math: 48<br />fitted_values: 0.45115236<br />prog: Academic","math: 48<br />fitted_values: 0.45115236<br />prog: Academic","math: 48<br />fitted_values: 0.45115236<br />prog: Academic","math: 48<br />fitted_values: 0.45115236<br />prog: Academic","math: 49<br />fitted_values: 0.48393834<br />prog: Academic","math: 49<br />fitted_values: 0.48393834<br />prog: Academic","math: 49<br />fitted_values: 0.48393834<br />prog: Academic","math: 49<br />fitted_values: 0.48393834<br />prog: Academic","math: 49<br />fitted_values: 0.48393834<br />prog: Academic","math: 49<br />fitted_values: 0.48393834<br />prog: Academic","math: 50<br />fitted_values: 0.51910693<br />prog: Academic","math: 50<br />fitted_values: 0.51910693<br />prog: Academic","math: 50<br />fitted_values: 0.51910693<br />prog: Academic","math: 50<br />fitted_values: 0.51910693<br />prog: Academic","math: 50<br />fitted_values: 0.51910693<br />prog: Academic","math: 51<br />fitted_values: 0.55683129<br />prog: Academic","math: 51<br />fitted_values: 0.55683129<br />prog: Academic","math: 51<br />fitted_values: 0.55683129<br />prog: Academic","math: 51<br />fitted_values: 0.55683129<br />prog: Academic","math: 51<br />fitted_values: 0.55683129<br />prog: Academic","math: 52<br />fitted_values: 0.59729713<br />prog: Academic","math: 52<br />fitted_values: 0.59729713<br />prog: Academic","math: 53<br />fitted_values: 0.64070369<br />prog: Academic","math: 53<br />fitted_values: 0.64070369<br />prog: Academic","math: 53<br />fitted_values: 0.64070369<br />prog: Academic","math: 53<br />fitted_values: 0.64070369<br />prog: Academic","math: 53<br />fitted_values: 0.64070369<br />prog: Academic","math: 54<br />fitted_values: 0.68726468<br />prog: Academic","math: 54<br />fitted_values: 0.68726468<br />prog: Academic","math: 54<br />fitted_values: 0.68726468<br />prog: Academic","math: 54<br />fitted_values: 0.68726468<br />prog: Academic","math: 54<br />fitted_values: 0.68726468<br />prog: Academic","math: 54<br />fitted_values: 0.68726468<br />prog: Academic","math: 55<br />fitted_values: 0.73720933<br />prog: Academic","math: 55<br />fitted_values: 0.73720933<br />prog: Academic","math: 56<br />fitted_values: 0.79078355<br />prog: Academic","math: 56<br />fitted_values: 0.79078355<br />prog: Academic","math: 57<br />fitted_values: 0.84825109<br />prog: Academic","math: 57<br />fitted_values: 0.84825109<br />prog: Academic","math: 57<br />fitted_values: 0.84825109<br />prog: Academic","math: 57<br />fitted_values: 0.84825109<br />prog: Academic","math: 57<br />fitted_values: 0.84825109<br />prog: Academic","math: 57<br />fitted_values: 0.84825109<br />prog: Academic","math: 57<br />fitted_values: 0.84825109<br />prog: Academic","math: 58<br />fitted_values: 0.90989488<br />prog: Academic","math: 58<br />fitted_values: 0.90989488<br />prog: Academic","math: 58<br />fitted_values: 0.90989488<br />prog: Academic","math: 59<br />fitted_values: 0.97601844<br />prog: Academic","math: 59<br />fitted_values: 0.97601844<br />prog: Academic","math: 60<br />fitted_values: 1.04694730<br />prog: Academic","math: 60<br />fitted_values: 1.04694730<br />prog: Academic","math: 60<br />fitted_values: 1.04694730<br />prog: Academic","math: 61<br />fitted_values: 1.12303068<br />prog: Academic","math: 61<br />fitted_values: 1.12303068<br />prog: Academic","math: 61<br />fitted_values: 1.12303068<br />prog: Academic","math: 61<br />fitted_values: 1.12303068<br />prog: Academic","math: 61<br />fitted_values: 1.12303068<br />prog: Academic","math: 62<br />fitted_values: 1.20464316<br />prog: Academic","math: 62<br />fitted_values: 1.20464316<br />prog: Academic","math: 62<br />fitted_values: 1.20464316<br />prog: Academic","math: 62<br />fitted_values: 1.20464316<br />prog: Academic","math: 63<br />fitted_values: 1.29218656<br />prog: Academic","math: 63<br />fitted_values: 1.29218656<br />prog: Academic","math: 63<br />fitted_values: 1.29218656<br />prog: Academic","math: 63<br />fitted_values: 1.29218656<br />prog: Academic","math: 64<br />fitted_values: 1.38609188<br />prog: Academic","math: 64<br />fitted_values: 1.38609188<br />prog: Academic","math: 64<br />fitted_values: 1.38609188<br />prog: Academic","math: 64<br />fitted_values: 1.38609188<br />prog: Academic","math: 64<br />fitted_values: 1.38609188<br />prog: Academic","math: 65<br />fitted_values: 1.48682145<br />prog: Academic","math: 65<br />fitted_values: 1.48682145<br />prog: Academic","math: 65<br />fitted_values: 1.48682145<br />prog: Academic","math: 66<br />fitted_values: 1.59487120<br />prog: Academic","math: 66<br />fitted_values: 1.59487120<br />prog: Academic","math: 66<br />fitted_values: 1.59487120<br />prog: Academic","math: 67<br />fitted_values: 1.71077311<br />prog: Academic","math: 67<br />fitted_values: 1.71077311<br />prog: Academic","math: 68<br />fitted_values: 1.83509780<br />prog: Academic","math: 69<br />fitted_values: 1.96845737<br />prog: Academic","math: 69<br />fitted_values: 1.96845737<br />prog: Academic","math: 70<br />fitted_values: 2.11150840<br />prog: Academic","math: 71<br />fitted_values: 2.26495518<br />prog: Academic","math: 71<br />fitted_values: 2.26495518<br />prog: Academic","math: 71<br />fitted_values: 2.26495518<br />prog: Academic","math: 71<br />fitted_values: 2.26495518<br />prog: Academic","math: 72<br />fitted_values: 2.42955319<br />prog: Academic","math: 72<br />fitted_values: 2.42955319<br />prog: Academic","math: 72<br />fitted_values: 2.42955319<br />prog: Academic","math: 73<br />fitted_values: 2.60611280<br />prog: Academic","math: 75<br />fitted_values: 2.99865711<br />prog: Academic"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Academic","legendgroup":"Academic","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[35,39,39,41,41,42,42,42,42,42,43,43,43,44,45,46,46,46,46,48,49,49,49,50,52,54,54,54,55,55,56,56,56,57,57,57,57,58,58,58,60,60,61,61,63],"y":[0.061311338470096857,0.081172326521828791,0.081172326521828791,0.093398863557851736,0.093398863557851736,0.10018631226518189,0.10018631226518189,0.10018631226518189,0.10018631226518189,0.10018631226518189,0.10746701601009717,0.10746701601009717,0.10746701601009717,0.11527682044574271,0.12365417618770996,0.13264032812093318,0.13264032812093318,0.13264032812093318,0.13264032812093318,0.15261920458943895,0.16371029267599477,0.16371029267599477,0.16371029267599477,0.17560738833725037,0.20205815461813637,0.23249305302165507,0.23249305302165507,0.23249305302165507,0.24938870476818439,0.24938870476818439,0.26751219125742925,0.26751219125742925,0.26751219125742925,0.28695274125534881,0.28695274125534881,0.28695274125534881,0.28695274125534881,0.30780606792877319,0.30780606792877319,0.30780606792877319,0.35416918761133737,0.35416918761133737,0.37990724376166479,0.37990724376166479,0.43713056339703699],"text":["math: 35<br />fitted_values: 0.06131134<br />prog: General","math: 39<br />fitted_values: 0.08117233<br />prog: General","math: 39<br />fitted_values: 0.08117233<br />prog: General","math: 41<br />fitted_values: 0.09339886<br />prog: General","math: 41<br />fitted_values: 0.09339886<br />prog: General","math: 42<br />fitted_values: 0.10018631<br />prog: General","math: 42<br />fitted_values: 0.10018631<br />prog: General","math: 42<br />fitted_values: 0.10018631<br />prog: General","math: 42<br />fitted_values: 0.10018631<br />prog: General","math: 42<br />fitted_values: 0.10018631<br />prog: General","math: 43<br />fitted_values: 0.10746702<br />prog: General","math: 43<br />fitted_values: 0.10746702<br />prog: General","math: 43<br />fitted_values: 0.10746702<br />prog: General","math: 44<br />fitted_values: 0.11527682<br />prog: General","math: 45<br />fitted_values: 0.12365418<br />prog: General","math: 46<br />fitted_values: 0.13264033<br />prog: General","math: 46<br />fitted_values: 0.13264033<br />prog: General","math: 46<br />fitted_values: 0.13264033<br />prog: General","math: 46<br />fitted_values: 0.13264033<br />prog: General","math: 48<br />fitted_values: 0.15261920<br />prog: General","math: 49<br />fitted_values: 0.16371029<br />prog: General","math: 49<br />fitted_values: 0.16371029<br />prog: General","math: 49<br />fitted_values: 0.16371029<br />prog: General","math: 50<br />fitted_values: 0.17560739<br />prog: General","math: 52<br />fitted_values: 0.20205815<br />prog: General","math: 54<br />fitted_values: 0.23249305<br />prog: General","math: 54<br />fitted_values: 0.23249305<br />prog: General","math: 54<br />fitted_values: 0.23249305<br />prog: General","math: 55<br />fitted_values: 0.24938870<br />prog: General","math: 55<br />fitted_values: 0.24938870<br />prog: General","math: 56<br />fitted_values: 0.26751219<br />prog: General","math: 56<br />fitted_values: 0.26751219<br />prog: General","math: 56<br />fitted_values: 0.26751219<br />prog: General","math: 57<br />fitted_values: 0.28695274<br />prog: General","math: 57<br />fitted_values: 0.28695274<br />prog: General","math: 57<br />fitted_values: 0.28695274<br />prog: General","math: 57<br />fitted_values: 0.28695274<br />prog: General","math: 58<br />fitted_values: 0.30780607<br />prog: General","math: 58<br />fitted_values: 0.30780607<br />prog: General","math: 58<br />fitted_values: 0.30780607<br />prog: General","math: 60<br />fitted_values: 0.35416919<br />prog: General","math: 60<br />fitted_values: 0.35416919<br />prog: General","math: 61<br />fitted_values: 0.37990724<br />prog: General","math: 61<br />fitted_values: 0.37990724<br />prog: General","math: 63<br />fitted_values: 0.43713056<br />prog: General"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(0,186,56,1)","dash":"solid"},"hoveron":"points","name":"General","legendgroup":"General","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[33,37,38,39,39,39,39,40,40,40,40,40,40,40,40,40,40,41,41,41,42,44,44,45,45,45,46,46,46,47,47,47,49,50,51,51,51,52,52,52,53,53,54,55,56,56,57,57,66,75],"y":[0.077128219677562879,0.10211287484398937,0.10953358505351242,0.1174935704533369,0.1174935704533369,0.1174935704533369,0.1174935704533369,0.12603202105663719,0.12603202105663719,0.12603202105663719,0.12603202105663719,0.12603202105663719,0.12603202105663719,0.12603202105663719,0.12603202105663719,0.12603202105663719,0.12603202105663719,0.13519097487916648,0.13519097487916648,0.13519097487916648,0.14501552490827826,0.16685840858628367,0.16685840858628367,0.17898428299764238,0.17898428299764238,0.17898428299764238,0.19199136460428601,0.19199136460428601,0.19199136460428601,0.20594369217939346,0.20594369217939346,0.20594369217939346,0.23696384754095676,0.25418439926297642,0.2726563967421784,0.2726563967421784,0.2726563967421784,0.29247078459569548,0.29247078459569548,0.29247078459569548,0.31372511653525154,0.31372511653525154,0.33652403566091343,0.3609797896585773,0.38721278343770171,0.38721278343770171,0.41535217193013246,0.41535217193013246,0.78094001762319532,1.4683137644165336],"text":["math: 33<br />fitted_values: 0.07712822<br />prog: Vocational","math: 37<br />fitted_values: 0.10211287<br />prog: Vocational","math: 38<br />fitted_values: 0.10953359<br />prog: Vocational","math: 39<br />fitted_values: 0.11749357<br />prog: Vocational","math: 39<br />fitted_values: 0.11749357<br />prog: Vocational","math: 39<br />fitted_values: 0.11749357<br />prog: Vocational","math: 39<br />fitted_values: 0.11749357<br />prog: Vocational","math: 40<br />fitted_values: 0.12603202<br />prog: Vocational","math: 40<br />fitted_values: 0.12603202<br />prog: Vocational","math: 40<br />fitted_values: 0.12603202<br />prog: Vocational","math: 40<br />fitted_values: 0.12603202<br />prog: Vocational","math: 40<br />fitted_values: 0.12603202<br />prog: Vocational","math: 40<br />fitted_values: 0.12603202<br />prog: Vocational","math: 40<br />fitted_values: 0.12603202<br />prog: Vocational","math: 40<br />fitted_values: 0.12603202<br />prog: Vocational","math: 40<br />fitted_values: 0.12603202<br />prog: Vocational","math: 40<br />fitted_values: 0.12603202<br />prog: Vocational","math: 41<br />fitted_values: 0.13519097<br />prog: Vocational","math: 41<br />fitted_values: 0.13519097<br />prog: Vocational","math: 41<br />fitted_values: 0.13519097<br />prog: Vocational","math: 42<br />fitted_values: 0.14501552<br />prog: Vocational","math: 44<br />fitted_values: 0.16685841<br />prog: Vocational","math: 44<br />fitted_values: 0.16685841<br />prog: Vocational","math: 45<br />fitted_values: 0.17898428<br />prog: Vocational","math: 45<br />fitted_values: 0.17898428<br />prog: Vocational","math: 45<br />fitted_values: 0.17898428<br />prog: Vocational","math: 46<br />fitted_values: 0.19199136<br />prog: Vocational","math: 46<br />fitted_values: 0.19199136<br />prog: Vocational","math: 46<br />fitted_values: 0.19199136<br />prog: Vocational","math: 47<br />fitted_values: 0.20594369<br />prog: Vocational","math: 47<br />fitted_values: 0.20594369<br />prog: Vocational","math: 47<br />fitted_values: 0.20594369<br />prog: Vocational","math: 49<br />fitted_values: 0.23696385<br />prog: Vocational","math: 50<br />fitted_values: 0.25418440<br />prog: Vocational","math: 51<br />fitted_values: 0.27265640<br />prog: Vocational","math: 51<br />fitted_values: 0.27265640<br />prog: Vocational","math: 51<br />fitted_values: 0.27265640<br />prog: Vocational","math: 52<br />fitted_values: 0.29247078<br />prog: Vocational","math: 52<br />fitted_values: 0.29247078<br />prog: Vocational","math: 52<br />fitted_values: 0.29247078<br />prog: Vocational","math: 53<br />fitted_values: 0.31372512<br />prog: Vocational","math: 53<br />fitted_values: 0.31372512<br />prog: Vocational","math: 54<br />fitted_values: 0.33652404<br />prog: Vocational","math: 55<br />fitted_values: 0.36097979<br />prog: Vocational","math: 56<br />fitted_values: 0.38721278<br />prog: Vocational","math: 56<br />fitted_values: 0.38721278<br />prog: Vocational","math: 57<br />fitted_values: 0.41535217<br />prog: Vocational","math: 57<br />fitted_values: 0.41535217<br />prog: Vocational","math: 66<br />fitted_values: 0.78094002<br />prog: Vocational","math: 75<br />fitted_values: 1.46831376<br />prog: Vocational"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(97,156,255,1)","dash":"solid"},"hoveron":"points","name":"Vocational","legendgroup":"Vocational","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283104,"r":7.3059360730593621,"b":40.182648401826491,"l":31.415525114155255},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[30.630664874603976,77.112825482161711],"tickmode":"array","ticktext":["40","50","60","70"],"tickvals":[40,50,60,70],"categoryorder":"array","categoryarray":["40","50","60","70"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Math Score","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.50908078876324003,6.3695703578088434],"tickmode":"array","ticktext":["0","2","4","6"],"tickvals":[0,2,4,6],"categoryorder":"array","categoryarray":["0","2","4","6"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Expected number of awards","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"prog","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"1c0423ca2d97":{"x":{},"y":{},"colour":{},"type":"scatter"},"1c0432ae48de":{"x":{},"y":{},"colour":{}}},"cur_data":"1c0423ca2d97","visdat":{"1c0423ca2d97":["function (y) ","x"],"1c0432ae48de":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<ul>
<li><p>This graph indicates that the most awards are earned by students in the <code>academic</code> program, especially if the student has a high math score.</p></li>
<li><p>Students in the <code>general program</code> earn the lowest number of awards</p></li>
</ul>
</section>
<section id="ci-of-cofficients" class="level2">
<h2 class="anchored" data-anchor-id="ci-of-cofficients">CI of cofficients</h2>
<ul>
<li>Construct and interpret the confidence intervals for each variable using <code>confint()</code>.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>beta interval</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-5.4857279</td>
<td style="text-align: right;">-2.8857230</td>
</tr>
<tr class="even">
<td style="text-align: left;">progGeneral</td>
<td style="text-align: right;">-1.8558691</td>
<td style="text-align: right;">-0.4350439</td>
</tr>
<tr class="odd">
<td style="text-align: left;">progVocational</td>
<td style="text-align: right;">-1.3905775</td>
<td style="text-align: right;">-0.1261624</td>
</tr>
<tr class="even">
<td style="text-align: left;">math</td>
<td style="text-align: right;">0.0494967</td>
<td style="text-align: right;">0.0910770</td>
</tr>
</tbody>
</table>


</div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>beta interval</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5 %</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-99.585448</td>
<td style="text-align: right;">-94.418558</td>
</tr>
<tr class="even">
<td style="text-align: left;">progGeneral</td>
<td style="text-align: right;">-84.368296</td>
<td style="text-align: right;">-35.276377</td>
</tr>
<tr class="odd">
<td style="text-align: left;">progVocational</td>
<td style="text-align: right;">-75.106849</td>
<td style="text-align: right;">-11.852828</td>
</tr>
<tr class="even">
<td style="text-align: left;">math</td>
<td style="text-align: right;">5.074217</td>
<td style="text-align: right;">9.535332</td>
</tr>
</tbody>
</table>


</div>
</div>
<ul>
<li><p>at <span class="math inline">\alpha = 0.05</span>, Compared to the students in <code>academic program</code>, the mean number of awards that students in <code>General program</code> decreases by 35% to 84% holding the math score constant.</p></li>
<li><p>With 95% confidence, the mean number of awards decrease by 11% to 75% for the student in <code>vocational program</code> vs.&nbsp;student in <code>academic programs</code>, holding the math score constant.</p></li>
<li><p>95% confidence interval of a the effect of 1-unit increase in math score on the mean number of award holding everything else constant is <code>5.07% to 9.53% increase</code></p></li>
</ul>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="model-comparison-criteria" class="level1">
<h1>Model Comparison Criteria</h1>
<p><a href="https://stats.stackexchange.com/questions/232465/how-to-compare-models-on-the-basis-of-aic">LINK1</a> <a href="https://www.scribbr.com/statistics/akaike-information-criterion/">LINK2</a></p>
<p>Recall that the general form of most information criteria is:</p>
<p><span class="math display">\text{IC}(k)=-2log(L(\hat{\beta}|y_1,.....,y_n))+kr</span></p>
<p>Where</p>
<ul>
<li><span class="math inline">\text{log}(L(\hat{\beta}|y_1,.....,y_n))</span> is the log-likelihood of an estimated model, - <code>n</code> is the sample size,</li>
<li><code>r</code> is the number of parameters in the model,</li>
<li><code>k</code> is a penalty term on the number of parameters.</li>
</ul>
<p>The three most common information criteria are:</p>
<section id="aic" class="level2">
<h2 class="anchored" data-anchor-id="aic">AIC</h2>
<p><span class="math display">AIC = IC(2) = -2log(L(\hat{\beta}|y_1,.....,y_n))+2r</span></p>
</section>
<section id="aic_c" class="level2">
<h2 class="anchored" data-anchor-id="aic_c">AIC_c</h2>
<p><span class="math display">AIC_c = IC(\frac{2n}{n-r-1}) = -2log(L(\hat{\beta}|y_1,.....,y_n))+r\frac{2n}{n-r-1}=AIC+\frac{2r(r+1)}{n-r-1}</span></p>
</section>
<section id="bic" class="level2">
<h2 class="anchored" data-anchor-id="bic">BIC</h2>
<p><span class="math display">BIC = IC(log(n)) = -2log(L(\hat{\beta}|y_1,.....,y_n))+rlog(n)</span></p>
</section>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">Example</h2>
<ul>
<li>Compute these three information criteria for the following three models and then rank the models based on each criterion using <code>AIC()</code>, <code>BIC()</code>, and <code>AICc()</code>.</li>
</ul>
<p><span class="math display">\text{mod.1:   }\log(mean\_num\_awards) = \beta_0 + \beta_1 prog + u  </span> <span class="math display">\text{mod.2:   }\log(mean\_num\_awards) = \beta_0 + \beta_1 math + u</span></p>
<p><span class="math display">\text{mod.3:   }\log(mean\_num\_awards) = \beta_0 + \beta_1 prog + \beta_2 math + u</span></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     mod.1    mod.2    mod.3
1 384.0762 416.5149 373.5045</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     mod.1    mod.2    mod.3
1 384.1371 416.6373 373.7096</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     mod.1    mod.2    mod.3
1 390.6728 426.4098 386.6978</code></pre>
</div>
</div>
<ul>
<li>The model with the <code>lowest</code> AIC, corrected AIC, or BIC score is preferred.
<ul>
<li>The absolute values of these scores do not matter.</li>
</ul></li>
<li>These scores can be negative or positive.
<ul>
<li>Based on all these three criteria, the third model with both math and program is the best, and the second model with the only program is the worst model</li>
</ul></li>
</ul>
</section>
</section>
<section id="model-assessment" class="level1">
<h1>Model Assessment</h1>
<p>Recall that the Pearson residuals correct for unequal variance in the raw residuals by dividing by the standard deviation:</p>
<p><span class="math display">e_m = \frac{y_m - \widehat{y_m}}{\sqrt{\widehat{\text{V}(Y_m)}}}</span></p>
<p>Standardized Pearson residuals also correct for overestimates of the standard deviation of <span class="math inline">y_m - \widehat{y_m}</span>:</p>
<p><span class="math display">r_m = \frac{y_m - \widehat{y_m}}{\sqrt{\widehat{\text{V}(Y_m-\hat{Y_m})}}}=\frac{y_m - \widehat{y_m}}{\sqrt{\widehat{\text{V}(Y_m)}-(1-h_m)}}</span> where <span class="math inline">h_m</span> is the mth diagonal element of the hat matrix.</p>
<ul>
<li>For the first Poisson model using <code>prog</code> and <code>math</code> as predictors, plot the standardized Pearson residuals against explanatory variables, fitted values, and the linear predictor to assess whether the model assumptions are satisfied.</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wk5_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wk5_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wk5_files/figure-html/unnamed-chunk-15-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We have four assumptions general assumptions for Poisson regression</p>
<ul>
<li><ol type="1">
<li>IID data.</li>
</ol></li>
<li><ol start="2" type="1">
<li>The distribution of the response is the one specified by the model, which here is Poisson.</li>
</ol></li>
<li><ol start="3" type="1">
<li>The mean of the distribution is linked to the explanatory variables by the <code>link function</code> that we specify. In Poisson is is log().</li>
</ol></li>
<li><ol start="4" type="1">
<li>The link relates to the explanatory variables in a <code>linear fashion</code>. Here linearity means using a linear combination of the regression parameters.</li>
</ol>
<ul>
<li>For <code>iid data</code>, we must discuss how the data is generated and look for possible clustering.
<ul>
<li>Here there could be some clustering among the students who are in the same program or same classroom, or same cohort, which would violate independence.</li>
</ul></li>
<li>The plot of the standardized residuals against <code>math</code> shows roughly the same variance throughout the math score range.
<ul>
<li><p>There is no severe curvature in the plot, suggesting we don’t need a transformation or additional polynomial terms.</p></li>
<li><p>Similarly, the plots of <code>residuals against the fitted values</code> and <code>linear predictor</code> have roughly constant variance.</p>
<ul>
<li>They show no evident curvature, so we can conclude that the link function fits well here.</li>
</ul></li>
</ul></li>
</ul></li>
<li><p>We can also use these plots to check for <code>extreme residuals</code>. In this case, there are numerous residuals whose magnitudes are larger than 2 or 3, scattered across the range of math scores.</p></li>
<li><p>This may be a sign of <code>overdispersion</code>, meaning more variability in the counts than the model estimated.</p></li>
<li><p>This is an indication that there may be important explanatory variables missing from the model</p></li>
</ul>
<div style="page-break-after: always;"></div>
</section>
<section id="goodness-of-fit" class="level1">
<h1>Goodness of Fit</h1>
<p><span class="math display">H_0: \text{Our Model is correct}</span> - The Pearson Statistic <span class="math inline">\chi^2</span> and Residual Deviance <span class="math inline">D</span> are often used to test the goodness of fit, where the null hypothesis is that our model is correct. Under asymptotic theory, both of these follow a chi-squared distribution with the same degrees of freedom as the residuals from the Poisson model.</p>
<p>We can also use these to test for overdispersion in our model since if our model is a good fit to the data we should not have overdispersion.</p>
<section id="the-pearson-statistics" class="level2">
<h2 class="anchored" data-anchor-id="the-pearson-statistics">The Pearson Statistics</h2>
<p><span class="math display">\chi^2=\sum_{i=1}^{n}\frac{(y_{i}-\exp\{\textbf{X}_{i}\hat{\beta}\})^{2}}{\exp\{\textbf{X}_{i}\hat{\beta}\}}</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Pearson statistic residuals</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>pearson_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(poisson.mod<span class="fl">.1</span>, <span class="at">type =</span> <span class="st">"pearson"</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>pearson_stat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 212.1437</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get p value associated with the pearson statistic</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>pearson_p.value <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(pearson_stat, poisson.mod<span class="fl">.1</span><span class="sc">$</span>df.residual,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>pearson_p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.203986</code></pre>
</div>
</div>
</section>
<section id="residual-deviance" class="level2">
<h2 class="anchored" data-anchor-id="residual-deviance">Residual Deviance</h2>
<p><span class="math display">D=2\sum_{i=1}^{n}\biggl[y_{i}\log\biggl(\frac{y_{i}}{\exp\{\textbf{X}_{i}\hat{\beta}\}}\biggr)-(y_{i}-\exp\{\textbf{X}_{i}\hat{\beta}\})\biggr]</span></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6182274</code></pre>
</div>
</div>
<ul>
<li><p><code>Goodness-of-fit statistics</code> test is a more objective measure of the overall fit.</p></li>
<li><p>The null hypothesis is that the model is correct against the alternative that it is not.</p></li>
<li><p>We can use both Pearson statistic or the residual deviance to perform this test</p></li>
<li><p>Here, the two non significant p-values indicate that we <code>fail to reject the null hypothesis that the model is correct</code></p></li>
</ul>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="directly-testing-for-over-dispersion" class="level1">
<h1>Directly Testing for Over Dispersion</h1>
<p>We can use a dispersion test for Poisson regression from the AER package that tests the null hypothesis that</p>
<p><span class="math display">\theta=1</span></p>
<p>vs.&nbsp;not in a regression of the form</p>
<p><span class="math display">\text{V}(Y_i)=(1+\alpha)*\lambda_i</span></p>
<ul>
<li><p>Note that if we set <span class="math inline">(1+\alpha)=\theta</span> we get the variance form for a quasipoisson above.</p></li>
<li><p>So this test is examining whether the variance of our outcome variable appears to come from a Poisson or quasipoisson distribution.</p></li>
</ul>
<p>If we reject the null hypothesis due to a small p-value, we have overdispersion if <span class="math inline">\alpha&gt;0</span> and underdispersion (smaller variance in reality which is less common) if <span class="math inline">\alpha&lt;0</span>.</p>
<p>The test itself reports the estimated dispersion value along with a p-value.</p>
<p>Run the test using <code>dispersiontest()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replace with your code</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dispersiontest</span>(poisson.mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Overdispersion test

data:  poisson.mod.1
z = 0.53224, p-value = 0.2973
alternative hypothesis: true dispersion is greater than 1
sample estimates:
dispersion 
  1.047254 </code></pre>
</div>
</div>
<ul>
<li><p>Note the dispersion estimate above 1 but lack of significant <code>p-value</code> since it is larger than 0.05.</p>
<ul>
<li>This means we fail to reject the <span class="math inline">H_0</span> that poission regression is value.</li>
</ul></li>
<li><p>If we reject the <span class="math inline">H_0</span> in an overdispersion test, that means we should fit a quasipoisson or <code>negative binomial regression</code>.</p></li>
<li><p>We can fit quasipoisson directly using <code>glm()</code> and specifying the appropriate family.</p></li>
<li><p>For a negative binomial using regression, we need to use <code>glm.nb()</code> from the MASS package.</p></li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
===========================================================
                             Dependent variable:           
                  -----------------------------------------
                                 num_awards                
                   Poisson  glm: quasipoisson   negative   
                               link = log       binomial   
                     (1)           (2)             (3)     
-----------------------------------------------------------
progGeneral       -1.084***     -1.084***       -1.075***  
                   (0.358)       (0.373)         (0.367)   
                                                           
progVocational    -0.714**      -0.714**        -0.708**   
                   (0.320)       (0.333)         (0.334)   
                                                           
math              0.070***      0.070***        0.071***   
                   (0.011)       (0.011)         (0.012)   
                                                           
Constant          -4.163***     -4.163***       -4.218***  
                   (0.663)       (0.690)         (0.713)   
                                                           
-----------------------------------------------------------
Observations         200           200             200     
Log Likelihood    -182.752                      -182.905   
theta                                         6.115 (5.577)
Akaike Inf. Crit.  373.505                       373.811   
===========================================================
Note:                           *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
<section id="reminders" class="level2">
<h2 class="anchored" data-anchor-id="reminders">Reminders</h2>
<ol type="1">
<li>Before next live session:
<ol type="1">
<li>Complete and turn in the Lab-1</li>
<li>Complete all videos and reading for unit 6</li>
</ol></li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>